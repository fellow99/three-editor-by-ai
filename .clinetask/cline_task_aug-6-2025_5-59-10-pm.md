**User:**

<task>
AssetBrowser.vue中：
- 上传模型文件按钮固定放在模型列表的第一项，不管列表有没有数据都显示该项
- 上传纹理文件按钮固定放在纹理列表的第一项，不管列表有没有数据都显示
</task>
<environment_details>
# VSCode Visible Files
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/0
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/1
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/2
src/components/editor/AssetBrowser.vue

# VSCode Open Tabs
src/components/editor/AssetBrowser.vue

# Current Time
2025/8/6 下午5:54:16 (Asia/Shanghai, UTC+8:00)

# Current Working Directory (d:/pci-workspace/3D/three-editor-by-ai) Files
.gitignore
index.html
LICENSE
package-lock.json
package.json
README.md
vite.config.js
public/
public/vite.svg
src/
src/App.vue
src/Editor.vue
src/main.js
src/style.css
src/assets/
src/assets/vue.svg
src/components/
src/components/editor/
src/components/editor/AssetBrowser.vue
src/components/editor/EditorFooter.vue
src/components/editor/Inspector.vue
src/components/editor/ObjectItem.vue
src/components/editor/PropertyPanel.vue
src/components/editor/Toolbar.vue
src/components/scene/
src/components/scene/Camera.vue
src/components/scene/CubeViewportControls.vue
src/components/scene/InteractionHints.vue
src/components/scene/ObjectGizmo.vue
src/components/scene/SceneViewer.vue
src/components/scene/ViewportControls.vue
src/composables/
src/composables/useAssets.js
src/composables/useObjectSelection.js
src/composables/useScene.js
src/composables/useTransform.js
src/core/
src/core/AssetLoader.js
src/core/InputManager.js
src/core/ObjectManager.js
src/core/SceneManager.js
src/services/
src/services/api.js
src/utils/
src/utils/fileUtils.js
src/utils/geometryUtils.js
src/utils/mathUtils.js

# Git Remote URLs
origin: https://github.com/fellow99/three-editor-by-ai.git

# Context Window Usage
0 / 128K tokens used (0%)

# Current Mode
ACT MODE
</environment_details>

---

**Assistant:**

<thinking>
根据用户需求，需要修改 AssetBrowser.vue，使“上传模型文件”按钮始终固定在模型列表第一项，“上传纹理文件”按钮始终固定在纹理列表第一项，无论列表有无数据。首先需要查看 AssetBrowser.vue 的实现，分析模型和纹理列表的渲染方式，以及上传按钮的实现方式。然后调整渲染逻辑，将上传按钮插入到列表的首位。由于只涉及 UI 逻辑调整，优先查看和修改 AssetBrowser.vue。
</thinking>

<read_file>
<path>src/components/editor/AssetBrowser.vue</path>
</read_file>

---

**User:**

[read_file for 'src/components/editor/AssetBrowser.vue'] Result:
<template>
  <div class="asset-browser">
    <!-- 拖拽上传区域 -->
    <div 
      v-if="dragState.isDragOver"
      class="drag-overlay"
      @dragenter="handleDragEnter"
      @dragover.prevent
      @dragleave="handleDragLeave"
      @drop="handleDrop"
    >
      <div class="drag-content">
        <span class="drag-icon">📥</span>
        <p>释放文件以上传</p>
      </div>
    </div>

    <!-- 上传进度 -->
    <div v-if="uploadState.isUploading" class="upload-progress">
      <div class="progress-header">
        <span>上传中... {{ uploadState.uploadProgress.toFixed(0) }}%</span>
      </div>
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          :style="{ width: uploadState.uploadProgress + '%' }"
        ></div>
      </div>
      <div class="upload-queue">
        <div 
          v-for="(item, index) in uploadState.uploadQueue" 
          :key="index"
          class="upload-item"
          :class="item.status"
        >
          <span class="item-name">{{ item.file.name }}</span>
          <span class="item-status">{{ getStatusText(item.status) }}</span>
        </div>
      </div>
    </div>

    <!-- 资源标签页 -->
    <div class="asset-tabs">
      <button 
        @click="activeTab = 'primitives'" 
        :class="['tab-btn', { active: activeTab === 'primitives' }]"
      >
        基础几何体
      </button>
      <button 
        @click="activeTab = 'models'" 
        :class="['tab-btn', { active: activeTab === 'models' }]"
      >
        3D模型 ({{ filteredModels.length }})
      </button>
      <button 
        @click="activeTab = 'textures'" 
        :class="['tab-btn', { active: activeTab === 'textures' }]"
      >
        纹理 ({{ filteredTextures.length }})
      </button>
    </div>

    <!-- 资源网格 -->
    <div class="asset-grid" 
         @dragenter="handleDragEnter"
         @dragover.prevent
         @dragleave="handleDragLeave"
         @drop="handleDrop">
      
      <!-- 基础几何体 -->
      <div v-if="activeTab === 'primitives'" class="primitives-grid">
        <div class="primitives-section">
          <h4 class="section-title">基础几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in basicPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">扩展几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in extendedPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">灯光</h4>
          <div class="primitives-list">
            <div 
              v-for="light in lightPrimitives" 
              :key="light.type"
              class="primitive-item"
              @click="addPrimitive(light.type)"
              :title="light.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ light.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ light.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">其他对象</h4>
          <div class="primitives-list">
            <div 
              v-for="other in otherPrimitives" 
              :key="other.type"
              class="primitive-item"
              @click="addPrimitive(other.type)"
              :title="other.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ other.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ other.name }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 3D模型 -->
      <div v-if="activeTab === 'models'" class="models-grid">
        <div 
          v-for="model in filteredModels" 
          :key="model.id"
          class="asset-item model-item"
          @click="selectModel(model)"
          @dblclick="addModelToScene(model.id)"
          :class="{ selected: selectedAssetId === model.id }"
        >
          <div class="asset-preview">
            <img 
              v-if="model.preview" 
              :src="model.preview" 
              :alt="model.name"
              class="preview-image"
            >
            <div v-else class="preview-placeholder">
              <span class="placeholder-icon">📦</span>
            </div>
            <button 
              @click.stop="toggleFavorite('model', model.id)"
              class="favorite-btn"
              :class="{ active: model.isFavorite }"
            >
              {{ model.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="model.name">{{ model.name }}</div>
            <div class="asset-meta">
              <span class="asset-type">{{ model.type }}</span>
              <span class="asset-size">{{ formatFileSize(model.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="addModelToScene(model.id)"
                class="action-btn add-btn"
                title="添加到场景"
              >
                <span class="icon">➕</span>
              </button>
              <button 
                @click.stop="showModelOptions(model)"
                class="action-btn options-btn"
                title="更多选项"
              >
                <span class="icon">⚙️</span>
              </button>
              <button 
                @click.stop="deleteAsset('model', model.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        
        <div v-if="filteredModels.length === 0" class="empty-state">
          <p>没有找到3D模型</p>
          <button @click="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])" class="upload-hint-btn">
            上传模型文件
          </button>
        </div>
      </div>

      <!-- 纹理 -->
      <div v-if="activeTab === 'textures'" class="textures-grid">
        <div 
          v-for="texture in filteredTextures" 
          :key="texture.id"
          class="asset-item texture-item"
          @click="selectTexture(texture)"
          :class="{ selected: selectedAssetId === texture.id }"
        >
          <div class="asset-preview">
            <img 
              :src="texture.preview" 
              :alt="texture.name"
              class="preview-image"
            >
            <button 
              @click.stop="toggleFavorite('texture', texture.id)"
              class="favorite-btn"
              :class="{ active: texture.isFavorite }"
            >
              {{ texture.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="texture.name">{{ texture.name }}</div>
            <div class="asset-meta">
              <span class="asset-resolution">{{ texture.width }}×{{ texture.height }}</span>
              <span class="asset-size">{{ formatFileSize(texture.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="applyTextureToSelected(texture)"
                class="action-btn apply-btn"
                title="应用到选中对象"
              >
                <span class="icon">🎨</span>
              </button>
              <button 
                @click.stop="deleteAsset('texture', texture.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        
        <div v-if="filteredTextures.length === 0" class="empty-state">
          <p>没有找到纹理</p>
          <button @click="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])" class="upload-hint-btn">
            上传纹理文件
          </button>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { ref, computed } from 'vue';
import { useAssets } from '../../composables/useAssets.js';
import { useObjectSelection } from '../../composables/useObjectSelection.js';
import { useScene } from '../../composables/useScene.js';

export default {
  name: 'AssetBrowser',
  /**
   * 资源浏览器组件
   * 提供模型、纹理、几何体的浏览与管理功能
   */
  setup() {
    const assets = useAssets();
    const objectSelection = useObjectSelection();
    const scene = useScene();
    
    // 本地状态
    const activeTab = ref('primitives');
    const selectedAssetId = ref(null);
    
    // 基础几何体数据
    const basicPrimitives = ref([
      {
        type: 'box',
        name: '立方体',
        icon: '⬜',
        description: '创建一个立方体几何体'
      },
      {
        type: 'sphere',
        name: '球体',
        icon: '⚪',
        description: '创建一个球体几何体'
      },
      {
        type: 'cylinder',
        name: '圆柱体',
        icon: '🥫',
        description: '创建一个圆柱体几何体'
      },
      {
        type: 'plane',
        name: '平面',
        icon: '▭',
        description: '创建一个平面几何体'
      },
      {
        type: 'cone',
        name: '圆锥体',
        icon: '🔺',
        description: '创建一个圆锥体几何体'
      },
      {
        type: 'torus',
        name: '圆环体',
        icon: '🍩',
        description: '创建一个圆环体几何体'
      }
    ]);

    // 扩展几何体数据
    const extendedPrimitives = ref([
      {
        type: 'dodecahedron',
        name: '十二面体',
        icon: '🎲',
        description: '创建一个十二面体几何体'
      },
      {
        type: 'icosahedron',
        name: '二十面体',
        icon: '💎',
        description: '创建一个二十面体几何体'
      },
      {
        type: 'octahedron',
        name: '八面体',
        icon: '🔸',
        description: '创建一个八面体几何体'
      },
      {
        type: 'tetrahedron',
        name: '四面体',
        icon: '🔻',
        description: '创建一个四面体几何体'
      },
      {
        type: 'ring',
        name: '环形',
        icon: '⭕',
        description: '创建一个环形几何体'
      },
      {
        type: 'tube',
        name: '管道',
        icon: '🌀',
        description: '创建一个管道几何体'
      }
    ]);

    // 灯光数据
    const lightPrimitives = ref([
      {
        type: 'directionalLight',
        name: '方向光',
        icon: '☀️',
        description: '创建一个方向光源'
      },
      {
        type: 'pointLight',
        name: '点光源',
        icon: '💡',
        description: '创建一个点光源'
      },
      {
        type: 'spotLight',
        name: '聚光灯',
        icon: '🔦',
        description: '创建一个聚光灯'
      },
      {
        type: 'ambientLight',
        name: '环境光',
        icon: '🌕',
        description: '创建一个环境光'
      },
      {
        type: 'hemisphereLight',
        name: '半球光',
        icon: '🌗',
        description: '创建一个半球光'
      }
    ]);

    // 其他对象数据
    const otherPrimitives = ref([
      {
        type: 'camera',
        name: '相机',
        icon: '📷',
        description: '创建一个透视相机'
      },
      {
        type: 'group',
        name: '空对象',
        icon: '📦',
        description: '创建一个空的组对象'
      },
      {
        type: 'text',
        name: '文本',
        icon: '📝',
        description: '创建一个3D文本对象'
      },
      {
        type: 'sprite',
        name: '精灵',
        icon: '🎭',
        description: '创建一个精灵对象'
      }
    ]);
    
    // 从assets composable获取状态
    const {
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      
      // 方法
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop
    } = assets;
    
    // 计算属性
    // categories、toggleSortOrder等已移除
    
    /**
     * 选中模型
     * @param {Object} model 模型对象
     */
    function selectModel(model) {
      selectedAssetId.value = model.id;
    }
    
    /**
     * 选中纹理
     * @param {Object} texture 纹理对象
     */
    function selectTexture(texture) {
      selectedAssetId.value = texture.id;
    }
    
    /**
     * 显示模型更多选项（待实现）
     * @param {Object} model 模型对象
     */
    function showModelOptions(model) {
      // TODO: 显示模型选项对话框
      console.log('显示模型选项:', model);
    }
    
    /**
     * 将纹理应用到选中的对象
     * @param {Object} texture 纹理对象
     */
    function applyTextureToSelected(texture) {
      const selectedObjects = objectSelection.selectedObjects.value;
      if (selectedObjects.length === 0) {
        alert('请先选择要应用纹理的对象');
        return;
      }
      
      selectedObjects.forEach(object => {
        if (object.material) {
          object.material.map = texture.texture;
          object.material.needsUpdate = true;
        }
      });
    }
    
    /**
     * 格式化文件大小
     * @param {number} bytes 字节数
     * @returns {string} 格式化结果
     */
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const sizes = ['B', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    /**
     * 获取上传状态文本
     * @param {string} status 状态码
     * @returns {string} 状态文本
     */
    function getStatusText(status) {
      const statusMap = {
        pending: '等待中',
        uploading: '上传中',
        completed: '已完成',
        failed: '失败'
      };
      return statusMap[status] || status;
    }

    // 添加几何体到场景
    /**
     * 添加几何体到场景
     * @param {string} type 几何体类型
     */
    function addPrimitive(type) {
      const position = [
        Math.random() * 4 - 2,
        Math.random() * 2,
        Math.random() * 4 - 2
      ];
      
      scene.createPrimitive(type, { position });
    }

    // 解构 selectAndUploadFiles 以便 setup 内和模板都能直接用
    const { selectAndUploadFiles } = assets;
    
    return {
      // 状态
      activeTab,
      selectedAssetId,
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      basicPrimitives,
      extendedPrimitives,
      lightPrimitives,
      otherPrimitives,
      
      // 方法
      selectModel,
      selectTexture,
      showModelOptions,
      applyTextureToSelected,
      formatFileSize,
      getStatusText,
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop,
      addPrimitive,
      selectAndUploadFiles
    };
  }
};
</script>

<style scoped>
.asset-browser {
  width: 100%;
  height: 100%;
  background: #2a2a2a;
  border-right: 1px solid #444;
  display: flex;
  flex-direction: column;
  color: #fff;
}

.browser-header {
  padding: 16px;
  border-bottom: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.browser-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.header-actions {
  display: flex;
  gap: 8px;
}

.upload-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
}

.upload-btn:hover {
  background: #0088dd;
}

.clear-btn {
  padding: 6px 8px;
  background: #d73a49;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.clear-btn:hover {
  background: #e85662;
}

.browser-filters {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
}

.search-box {
  position: relative;
  margin-bottom: 12px;
}

.search-input {
  width: 100%;
  padding: 8px 32px 8px 12px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.search-input:focus {
  outline: none;
  border-color: #007acc;
}

.search-icon {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
  font-size: 14px;
}

.filter-controls {
  display: flex;
  gap: 8px;
  align-items: center;
}

.category-select,
.sort-select {
  flex: 1;
  padding: 6px 8px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.sort-order-btn {
  padding: 6px 8px;
  background: #555;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.sort-order-btn:hover {
  background: #666;
}

.drag-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 122, 204, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.drag-content {
  text-align: center;
  color: #fff;
}

.drag-icon {
  font-size: 48px;
  display: block;
  margin-bottom: 16px;
}

.upload-progress {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
  background: #333;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  font-size: 12px;
}

.progress-bar {
  height: 4px;
  background: #555;
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 8px;
}

.progress-fill {
  height: 100%;
  background: #007acc;
  transition: width 0.3s;
}

.upload-queue {
  max-height: 120px;
  overflow-y: auto;
}

.upload-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
  font-size: 11px;
}

.upload-item.completed {
  color: #4caf50;
}

.upload-item.failed {
  color: #f44336;
}

.asset-tabs {
  display: flex;
  border-bottom: 1px solid #444;
}

.tab-btn {
  flex: 1;
  padding: 12px 16px;
  background: #333;
  border: none;
  border-bottom: 2px solid transparent;
  color: #aaa;
  font-size: 12px;
  cursor: pointer;
}

.tab-btn:hover {
  background: #444;
  color: #fff;
}

.tab-btn.active {
  background: #2a2a2a;
  border-bottom-color: #007acc;
  color: #fff;
}

.asset-grid {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.models-grid,
.textures-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
}

.asset-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}

.asset-item:hover {
  border-color: #777;
  transform: translateY(-2px);
}

.asset-item.selected {
  border-color: #007acc;
  box-shadow: 0 0 0 1px #007acc;
}

.asset-preview {
  position: relative;
  width: 100%;
  height: 80px;
  overflow: hidden;
}

.preview-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.preview-placeholder {
  width: 100%;
  height: 100%;
  background: #555;
  display: flex;
  align-items: center;
  justify-content: center;
}

.placeholder-icon {
  font-size: 24px;
  color: #888;
}

.favorite-btn {
  position: absolute;
  top: 4px;
  right: 4px;
  background: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  color: #fff;
  cursor: pointer;
  font-size: 12px;
}

.favorite-btn.active {
  color: #ffd700;
}

.asset-info {
  padding: 8px;
}

.asset-name {
  font-size: 11px;
  font-weight: 600;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.asset-meta {
  display: flex;
  justify-content: space-between;
  font-size: 9px;
  color: #aaa;
  margin-bottom: 8px;
}

.asset-actions {
  display: flex;
  gap: 4px;
}

.action-btn {
  flex: 1;
  padding: 4px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 10px;
}

.add-btn {
  background: #4caf50;
  color: #fff;
}

.apply-btn {
  background: #ff9800;
  color: #fff;
}

.options-btn {
  background: #555;
  color: #fff;
}

.delete-btn {
  background: #f44336;
  color: #fff;
}

.action-btn:hover {
  opacity: 0.8;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #aaa;
}

.upload-hint-btn {
  padding: 8px 16px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
  margin-top: 12px;
}

.upload-hint-btn:hover {
  background: #0088dd;
}

/* 几何体样式 */
.primitives-grid {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.primitives-section {
  margin-bottom: 16px;
}

.section-title {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  border-bottom: 1px solid #555;
  padding-bottom: 8px;
}

.primitives-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 8px;
}

.primitive-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  overflow: hidden;
}

.primitive-item:hover {
  background: #444;
  border-color: #777;
  transform: translateY(-1px);
}

.primitive-item:active {
  transform: translateY(0);
  background: #007acc;
  border-color: #0088dd;
}

.primitive-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 60px;
  background: #2a2a2a;
}

.primitive-icon {
  font-size: 24px;
  line-height: 1;
}

.primitive-info {
  padding: 8px 6px;
  text-align: center;
}

.primitive-name {
  font-size: 10px;
  font-weight: 500;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 移动端响应式 */
@media (max-width: 768px) {
  .primitives-list {
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 6px;
  }
  
  .primitive-preview {
    height: 50px;
  }
  
  .primitive-icon {
    font-size: 20px;
  }
  
  .primitive-name {
    font-size: 9px;
  }
  
  .section-title {
    font-size: 12px;
  }
}
</style>

<environment_details>
# VSCode Visible Files
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/0
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/1
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/2
src/components/editor/AssetBrowser.vue

# VSCode Open Tabs
src/components/editor/AssetBrowser.vue

# Current Time
2025/8/6 下午5:54:25 (Asia/Shanghai, UTC+8:00)

# Context Window Usage
144 / 111.452K tokens used (0%)

# Current Mode
ACT MODE
</environment_details>

---

**Assistant:**

<thinking>
当前 AssetBrowser.vue 中，“上传模型文件”按钮只在模型列表为空时显示，“上传纹理文件”按钮只在纹理列表为空时显示。需要将上传按钮固定为列表第一项，无论有无数据都显示。实现方式为：在 v-for 渲染模型和纹理列表时，先渲染上传按钮，再渲染列表项。只需调整 template 部分的 models-grid 和 textures-grid 结构。
</thinking>

<replace_in_file>
<path>src/components/editor/AssetBrowser.vue</path>
<diff>
------- SEARCH
<div v-if="activeTab === 'models'" class="models-grid">
        <div 
          v-for="model in filteredModels" 
          :key="model.id"
          class="asset-item model-item"
          @click="selectModel(model)"
          @dblclick="addModelToScene(model.id)"
          :class="{ selected: selectedAssetId === model.id }"
        >
          <div class="asset-preview">
            <img 
              v-if="model.preview" 
              :src="model.preview" 
              :alt="model.name"
              class="preview-image"
            >
            <div v-else class="preview-placeholder">
              <span class="placeholder-icon">📦</span>
            </div>
            <button 
              @click.stop="toggleFavorite('model', model.id)"
              class="favorite-btn"
              :class="{ active: model.isFavorite }"
            >
              {{ model.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="model.name">{{ model.name }}</div>
            <div class="asset-meta">
              <span class="asset-type">{{ model.type }}</span>
              <span class="asset-size">{{ formatFileSize(model.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="addModelToScene(model.id)"
                class="action-btn add-btn"
                title="添加到场景"
              >
                <span class="icon">➕</span>
              </button>
              <button 
                @click.stop="showModelOptions(model)"
                class="action-btn options-btn"
                title="更多选项"
              >
                <span class="icon">⚙️</span>
              </button>
              <button 
                @click.stop="deleteAsset('model', model.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        
        <div v-if="filteredModels.length === 0" class="empty-state">
          <p>没有找到3D模型</p>
          <button @click="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])" class="upload-hint-btn">
            上传模型文件
          </button>
        </div>
      </div>
=======
<div v-if="activeTab === 'models'" class="models-grid">
        <!-- 固定上传模型按钮 -->
        <div class="asset-item model-item upload-item-fixed">
          <div class="asset-preview">
            <div class="preview-placeholder">
              <span class="placeholder-icon">⬆️</span>
            </div>
          </div>
          <div class="asset-info">
            <div class="asset-name" title="上传模型文件">上传模型文件</div>
            <div class="asset-actions">
              <button 
                @click.stop="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])"
                class="action-btn add-btn"
                title="上传模型文件"
              >
                <span class="icon">⬆️</span>
              </button>
            </div>
          </div>
        </div>
        <!-- 渲染模型列表 -->
        <div 
          v-for="model in filteredModels" 
          :key="model.id"
          class="asset-item model-item"
          @click="selectModel(model)"
          @dblclick="addModelToScene(model.id)"
          :class="{ selected: selectedAssetId === model.id }"
        >
          <div class="asset-preview">
            <img 
              v-if="model.preview" 
              :src="model.preview" 
              :alt="model.name"
              class="preview-image"
            >
            <div v-else class="preview-placeholder">
              <span class="placeholder-icon">📦</span>
            </div>
            <button 
              @click.stop="toggleFavorite('model', model.id)"
              class="favorite-btn"
              :class="{ active: model.isFavorite }"
            >
              {{ model.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="model.name">{{ model.name }}</div>
            <div class="asset-meta">
              <span class="asset-type">{{ model.type }}</span>
              <span class="asset-size">{{ formatFileSize(model.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="addModelToScene(model.id)"
                class="action-btn add-btn"
                title="添加到场景"
              >
                <span class="icon">➕</span>
              </button>
              <button 
                @click.stop="showModelOptions(model)"
                class="action-btn options-btn"
                title="更多选项"
              >
                <span class="icon">⚙️</span>
              </button>
              <button 
                @click.stop="deleteAsset('model', model.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredModels.length === 0" class="empty-state">
          <p>没有找到3D模型</p>
        </div>
      </div>
+++++++ REPLACE

------- SEARCH
<div v-if="activeTab === 'textures'" class="textures-grid">
        <div 
          v-for="texture in filteredTextures" 
          :key="texture.id"
          class="asset-item texture-item"
          @click="selectTexture(texture)"
          :class="{ selected: selectedAssetId === texture.id }"
        >
          <div class="asset-preview">
            <img 
              :src="texture.preview" 
              :alt="texture.name"
              class="preview-image"
            >
            <button 
              @click.stop="toggleFavorite('texture', texture.id)"
              class="favorite-btn"
              :class="{ active: texture.isFavorite }"
            >
              {{ texture.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="texture.name">{{ texture.name }}</div>
            <div class="asset-meta">
              <span class="asset-resolution">{{ texture.width }}×{{ texture.height }}</span>
              <span class="asset-size">{{ formatFileSize(texture.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="applyTextureToSelected(texture)"
                class="action-btn apply-btn"
                title="应用到选中对象"
              >
                <span class="icon">🎨</span>
              </button>
              <button 
                @click.stop="deleteAsset('texture', texture.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        
        <div v-if="filteredTextures.length === 0" class="empty-state">
          <p>没有找到纹理</p>
          <button @click="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])" class="upload-hint-btn">
            上传纹理文件
          </button>
        </div>
      </div>
=======
<div v-if="activeTab === 'textures'" class="textures-grid">
        <!-- 固定上传纹理按钮 -->
        <div class="asset-item texture-item upload-item-fixed">
          <div class="asset-preview">
            <div class="preview-placeholder">
              <span class="placeholder-icon">⬆️</span>
            </div>
          </div>
          <div class="asset-info">
            <div class="asset-name" title="上传纹理文件">上传纹理文件</div>
            <div class="asset-actions">
              <button 
                @click.stop="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])"
                class="action-btn add-btn"
                title="上传纹理文件"
              >
                <span class="icon">⬆️</span>
              </button>
            </div>
          </div>
        </div>
        <!-- 渲染纹理列表 -->
        <div 
          v-for="texture in filteredTextures" 
          :key="texture.id"
          class="asset-item texture-item"
          @click="selectTexture(texture)"
          :class="{ selected: selectedAssetId === texture.id }"
        >
          <div class="asset-preview">
            <img 
              :src="texture.preview" 
              :alt="texture.name"
              class="preview-image"
            >
            <button 
              @click.stop="toggleFavorite('texture', texture.id)"
              class="favorite-btn"
              :class="{ active: texture.isFavorite }"
            >
              {{ texture.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="texture.name">{{ texture.name }}</div>
            <div class="asset-meta">
              <span class="asset-resolution">{{ texture.width }}×{{ texture.height }}</span>
              <span class="asset-size">{{ formatFileSize(texture.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="applyTextureToSelected(texture)"
                class="action-btn apply-btn"
                title="应用到选中对象"
              >
                <span class="icon">🎨</span>
              </button>
              <button 
                @click.stop="deleteAsset('texture', texture.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredTextures.length === 0" class="empty-state">
          <p>没有找到纹理</p>
        </div>
      </div>
+++++++ REPLACE
</diff>
</replace_in_file>

---

**User:**

[replace_in_file for 'src/components/editor/AssetBrowser.vue'] Result:
The content was successfully saved to src/components/editor/AssetBrowser.vue.

Here is the full, updated content of the file that was saved:

<final_file_content path="src/components/editor/AssetBrowser.vue">
<template>
  <div class="asset-browser">
    <!-- 拖拽上传区域 -->
    <div 
      v-if="dragState.isDragOver"
      class="drag-overlay"
      @dragenter="handleDragEnter"
      @dragover.prevent
      @dragleave="handleDragLeave"
      @drop="handleDrop"
    >
      <div class="drag-content">
        <span class="drag-icon">📥</span>
        <p>释放文件以上传</p>
      </div>
    </div>

    <!-- 上传进度 -->
    <div v-if="uploadState.isUploading" class="upload-progress">
      <div class="progress-header">
        <span>上传中... {{ uploadState.uploadProgress.toFixed(0) }}%</span>
      </div>
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          :style="{ width: uploadState.uploadProgress + '%' }"
        ></div>
      </div>
      <div class="upload-queue">
        <div 
          v-for="(item, index) in uploadState.uploadQueue" 
          :key="index"
          class="upload-item"
          :class="item.status"
        >
          <span class="item-name">{{ item.file.name }}</span>
          <span class="item-status">{{ getStatusText(item.status) }}</span>
        </div>
      </div>
    </div>

    <!-- 资源标签页 -->
    <div class="asset-tabs">
      <button 
        @click="activeTab = 'primitives'" 
        :class="['tab-btn', { active: activeTab === 'primitives' }]"
      >
        基础几何体
      </button>
      <button 
        @click="activeTab = 'models'" 
        :class="['tab-btn', { active: activeTab === 'models' }]"
      >
        3D模型 ({{ filteredModels.length }})
      </button>
      <button 
        @click="activeTab = 'textures'" 
        :class="['tab-btn', { active: activeTab === 'textures' }]"
      >
        纹理 ({{ filteredTextures.length }})
      </button>
    </div>

    <!-- 资源网格 -->
    <div class="asset-grid" 
         @dragenter="handleDragEnter"
         @dragover.prevent
         @dragleave="handleDragLeave"
         @drop="handleDrop">
      
      <!-- 基础几何体 -->
      <div v-if="activeTab === 'primitives'" class="primitives-grid">
        <div class="primitives-section">
          <h4 class="section-title">基础几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in basicPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">扩展几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in extendedPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">灯光</h4>
          <div class="primitives-list">
            <div 
              v-for="light in lightPrimitives" 
              :key="light.type"
              class="primitive-item"
              @click="addPrimitive(light.type)"
              :title="light.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ light.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ light.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">其他对象</h4>
          <div class="primitives-list">
            <div 
              v-for="other in otherPrimitives" 
              :key="other.type"
              class="primitive-item"
              @click="addPrimitive(other.type)"
              :title="other.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ other.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ other.name }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 3D模型 -->
<div v-if="activeTab === 'models'" class="models-grid">
        <!-- 固定上传模型按钮 -->
        <div class="asset-item model-item upload-item-fixed">
          <div class="asset-preview">
            <div class="preview-placeholder">
              <span class="placeholder-icon">⬆️</span>
            </div>
          </div>
          <div class="asset-info">
            <div class="asset-name" title="上传模型文件">上传模型文件</div>
            <div class="asset-actions">
              <button 
                @click.stop="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])"
                class="action-btn add-btn"
                title="上传模型文件"
              >
                <span class="icon">⬆️</span>
              </button>
            </div>
          </div>
        </div>
        <!-- 渲染模型列表 -->
        <div 
          v-for="model in filteredModels" 
          :key="model.id"
          class="asset-item model-item"
          @click="selectModel(model)"
          @dblclick="addModelToScene(model.id)"
          :class="{ selected: selectedAssetId === model.id }"
        >
          <div class="asset-preview">
            <img 
              v-if="model.preview" 
              :src="model.preview" 
              :alt="model.name"
              class="preview-image"
            >
            <div v-else class="preview-placeholder">
              <span class="placeholder-icon">📦</span>
            </div>
            <button 
              @click.stop="toggleFavorite('model', model.id)"
              class="favorite-btn"
              :class="{ active: model.isFavorite }"
            >
              {{ model.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="model.name">{{ model.name }}</div>
            <div class="asset-meta">
              <span class="asset-type">{{ model.type }}</span>
              <span class="asset-size">{{ formatFileSize(model.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="addModelToScene(model.id)"
                class="action-btn add-btn"
                title="添加到场景"
              >
                <span class="icon">➕</span>
              </button>
              <button 
                @click.stop="showModelOptions(model)"
                class="action-btn options-btn"
                title="更多选项"
              >
                <span class="icon">⚙️</span>
              </button>
              <button 
                @click.stop="deleteAsset('model', model.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredModels.length === 0" class="empty-state">
          <p>没有找到3D模型</p>
        </div>
      </div>

      <!-- 纹理 -->
<div v-if="activeTab === 'textures'" class="textures-grid">
        <!-- 固定上传纹理按钮 -->
        <div class="asset-item texture-item upload-item-fixed">
          <div class="asset-preview">
            <div class="preview-placeholder">
              <span class="placeholder-icon">⬆️</span>
            </div>
          </div>
          <div class="asset-info">
            <div class="asset-name" title="上传纹理文件">上传纹理文件</div>
            <div class="asset-actions">
              <button 
                @click.stop="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])"
                class="action-btn add-btn"
                title="上传纹理文件"
              >
                <span class="icon">⬆️</span>
              </button>
            </div>
          </div>
        </div>
        <!-- 渲染纹理列表 -->
        <div 
          v-for="texture in filteredTextures" 
          :key="texture.id"
          class="asset-item texture-item"
          @click="selectTexture(texture)"
          :class="{ selected: selectedAssetId === texture.id }"
        >
          <div class="asset-preview">
            <img 
              :src="texture.preview" 
              :alt="texture.name"
              class="preview-image"
            >
            <button 
              @click.stop="toggleFavorite('texture', texture.id)"
              class="favorite-btn"
              :class="{ active: texture.isFavorite }"
            >
              {{ texture.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="texture.name">{{ texture.name }}</div>
            <div class="asset-meta">
              <span class="asset-resolution">{{ texture.width }}×{{ texture.height }}</span>
              <span class="asset-size">{{ formatFileSize(texture.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="applyTextureToSelected(texture)"
                class="action-btn apply-btn"
                title="应用到选中对象"
              >
                <span class="icon">🎨</span>
              </button>
              <button 
                @click.stop="deleteAsset('texture', texture.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredTextures.length === 0" class="empty-state">
          <p>没有找到纹理</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { ref, computed } from 'vue';
import { useAssets } from '../../composables/useAssets.js';
import { useObjectSelection } from '../../composables/useObjectSelection.js';
import { useScene } from '../../composables/useScene.js';

export default {
  name: 'AssetBrowser',
  /**
   * 资源浏览器组件
   * 提供模型、纹理、几何体的浏览与管理功能
   */
  setup() {
    const assets = useAssets();
    const objectSelection = useObjectSelection();
    const scene = useScene();
    
    // 本地状态
    const activeTab = ref('primitives');
    const selectedAssetId = ref(null);
    
    // 基础几何体数据
    const basicPrimitives = ref([
      {
        type: 'box',
        name: '立方体',
        icon: '⬜',
        description: '创建一个立方体几何体'
      },
      {
        type: 'sphere',
        name: '球体',
        icon: '⚪',
        description: '创建一个球体几何体'
      },
      {
        type: 'cylinder',
        name: '圆柱体',
        icon: '🥫',
        description: '创建一个圆柱体几何体'
      },
      {
        type: 'plane',
        name: '平面',
        icon: '▭',
        description: '创建一个平面几何体'
      },
      {
        type: 'cone',
        name: '圆锥体',
        icon: '🔺',
        description: '创建一个圆锥体几何体'
      },
      {
        type: 'torus',
        name: '圆环体',
        icon: '🍩',
        description: '创建一个圆环体几何体'
      }
    ]);

    // 扩展几何体数据
    const extendedPrimitives = ref([
      {
        type: 'dodecahedron',
        name: '十二面体',
        icon: '🎲',
        description: '创建一个十二面体几何体'
      },
      {
        type: 'icosahedron',
        name: '二十面体',
        icon: '💎',
        description: '创建一个二十面体几何体'
      },
      {
        type: 'octahedron',
        name: '八面体',
        icon: '🔸',
        description: '创建一个八面体几何体'
      },
      {
        type: 'tetrahedron',
        name: '四面体',
        icon: '🔻',
        description: '创建一个四面体几何体'
      },
      {
        type: 'ring',
        name: '环形',
        icon: '⭕',
        description: '创建一个环形几何体'
      },
      {
        type: 'tube',
        name: '管道',
        icon: '🌀',
        description: '创建一个管道几何体'
      }
    ]);

    // 灯光数据
    const lightPrimitives = ref([
      {
        type: 'directionalLight',
        name: '方向光',
        icon: '☀️',
        description: '创建一个方向光源'
      },
      {
        type: 'pointLight',
        name: '点光源',
        icon: '💡',
        description: '创建一个点光源'
      },
      {
        type: 'spotLight',
        name: '聚光灯',
        icon: '🔦',
        description: '创建一个聚光灯'
      },
      {
        type: 'ambientLight',
        name: '环境光',
        icon: '🌕',
        description: '创建一个环境光'
      },
      {
        type: 'hemisphereLight',
        name: '半球光',
        icon: '🌗',
        description: '创建一个半球光'
      }
    ]);

    // 其他对象数据
    const otherPrimitives = ref([
      {
        type: 'camera',
        name: '相机',
        icon: '📷',
        description: '创建一个透视相机'
      },
      {
        type: 'group',
        name: '空对象',
        icon: '📦',
        description: '创建一个空的组对象'
      },
      {
        type: 'text',
        name: '文本',
        icon: '📝',
        description: '创建一个3D文本对象'
      },
      {
        type: 'sprite',
        name: '精灵',
        icon: '🎭',
        description: '创建一个精灵对象'
      }
    ]);
    
    // 从assets composable获取状态
    const {
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      
      // 方法
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop
    } = assets;
    
    // 计算属性
    // categories、toggleSortOrder等已移除
    
    /**
     * 选中模型
     * @param {Object} model 模型对象
     */
    function selectModel(model) {
      selectedAssetId.value = model.id;
    }
    
    /**
     * 选中纹理
     * @param {Object} texture 纹理对象
     */
    function selectTexture(texture) {
      selectedAssetId.value = texture.id;
    }
    
    /**
     * 显示模型更多选项（待实现）
     * @param {Object} model 模型对象
     */
    function showModelOptions(model) {
      // TODO: 显示模型选项对话框
      console.log('显示模型选项:', model);
    }
    
    /**
     * 将纹理应用到选中的对象
     * @param {Object} texture 纹理对象
     */
    function applyTextureToSelected(texture) {
      const selectedObjects = objectSelection.selectedObjects.value;
      if (selectedObjects.length === 0) {
        alert('请先选择要应用纹理的对象');
        return;
      }
      
      selectedObjects.forEach(object => {
        if (object.material) {
          object.material.map = texture.texture;
          object.material.needsUpdate = true;
        }
      });
    }
    
    /**
     * 格式化文件大小
     * @param {number} bytes 字节数
     * @returns {string} 格式化结果
     */
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const sizes = ['B', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    /**
     * 获取上传状态文本
     * @param {string} status 状态码
     * @returns {string} 状态文本
     */
    function getStatusText(status) {
      const statusMap = {
        pending: '等待中',
        uploading: '上传中',
        completed: '已完成',
        failed: '失败'
      };
      return statusMap[status] || status;
    }

    // 添加几何体到场景
    /**
     * 添加几何体到场景
     * @param {string} type 几何体类型
     */
    function addPrimitive(type) {
      const position = [
        Math.random() * 4 - 2,
        Math.random() * 2,
        Math.random() * 4 - 2
      ];
      
      scene.createPrimitive(type, { position });
    }

    // 解构 selectAndUploadFiles 以便 setup 内和模板都能直接用
    const { selectAndUploadFiles } = assets;
    
    return {
      // 状态
      activeTab,
      selectedAssetId,
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      basicPrimitives,
      extendedPrimitives,
      lightPrimitives,
      otherPrimitives,
      
      // 方法
      selectModel,
      selectTexture,
      showModelOptions,
      applyTextureToSelected,
      formatFileSize,
      getStatusText,
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop,
      addPrimitive,
      selectAndUploadFiles
    };
  }
};
</script>

<style scoped>
.asset-browser {
  width: 100%;
  height: 100%;
  background: #2a2a2a;
  border-right: 1px solid #444;
  display: flex;
  flex-direction: column;
  color: #fff;
}

.browser-header {
  padding: 16px;
  border-bottom: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.browser-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.header-actions {
  display: flex;
  gap: 8px;
}

.upload-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
}

.upload-btn:hover {
  background: #0088dd;
}

.clear-btn {
  padding: 6px 8px;
  background: #d73a49;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.clear-btn:hover {
  background: #e85662;
}

.browser-filters {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
}

.search-box {
  position: relative;
  margin-bottom: 12px;
}

.search-input {
  width: 100%;
  padding: 8px 32px 8px 12px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.search-input:focus {
  outline: none;
  border-color: #007acc;
}

.search-icon {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
  font-size: 14px;
}

.filter-controls {
  display: flex;
  gap: 8px;
  align-items: center;
}

.category-select,
.sort-select {
  flex: 1;
  padding: 6px 8px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.sort-order-btn {
  padding: 6px 8px;
  background: #555;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.sort-order-btn:hover {
  background: #666;
}

.drag-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 122, 204, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.drag-content {
  text-align: center;
  color: #fff;
}

.drag-icon {
  font-size: 48px;
  display: block;
  margin-bottom: 16px;
}

.upload-progress {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
  background: #333;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  font-size: 12px;
}

.progress-bar {
  height: 4px;
  background: #555;
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 8px;
}

.progress-fill {
  height: 100%;
  background: #007acc;
  transition: width 0.3s;
}

.upload-queue {
  max-height: 120px;
  overflow-y: auto;
}

.upload-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
  font-size: 11px;
}

.upload-item.completed {
  color: #4caf50;
}

.upload-item.failed {
  color: #f44336;
}

.asset-tabs {
  display: flex;
  border-bottom: 1px solid #444;
}

.tab-btn {
  flex: 1;
  padding: 12px 16px;
  background: #333;
  border: none;
  border-bottom: 2px solid transparent;
  color: #aaa;
  font-size: 12px;
  cursor: pointer;
}

.tab-btn:hover {
  background: #444;
  color: #fff;
}

.tab-btn.active {
  background: #2a2a2a;
  border-bottom-color: #007acc;
  color: #fff;
}

.asset-grid {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.models-grid,
.textures-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
}

.asset-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}

.asset-item:hover {
  border-color: #777;
  transform: translateY(-2px);
}

.asset-item.selected {
  border-color: #007acc;
  box-shadow: 0 0 0 1px #007acc;
}

.asset-preview {
  position: relative;
  width: 100%;
  height: 80px;
  overflow: hidden;
}

.preview-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.preview-placeholder {
  width: 100%;
  height: 100%;
  background: #555;
  display: flex;
  align-items: center;
  justify-content: center;
}

.placeholder-icon {
  font-size: 24px;
  color: #888;
}

.favorite-btn {
  position: absolute;
  top: 4px;
  right: 4px;
  background: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  color: #fff;
  cursor: pointer;
  font-size: 12px;
}

.favorite-btn.active {
  color: #ffd700;
}

.asset-info {
  padding: 8px;
}

.asset-name {
  font-size: 11px;
  font-weight: 600;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.asset-meta {
  display: flex;
  justify-content: space-between;
  font-size: 9px;
  color: #aaa;
  margin-bottom: 8px;
}

.asset-actions {
  display: flex;
  gap: 4px;
}

.action-btn {
  flex: 1;
  padding: 4px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 10px;
}

.add-btn {
  background: #4caf50;
  color: #fff;
}

.apply-btn {
  background: #ff9800;
  color: #fff;
}

.options-btn {
  background: #555;
  color: #fff;
}

.delete-btn {
  background: #f44336;
  color: #fff;
}

.action-btn:hover {
  opacity: 0.8;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #aaa;
}

.upload-hint-btn {
  padding: 8px 16px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
  margin-top: 12px;
}

.upload-hint-btn:hover {
  background: #0088dd;
}

/* 几何体样式 */
.primitives-grid {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.primitives-section {
  margin-bottom: 16px;
}

.section-title {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  border-bottom: 1px solid #555;
  padding-bottom: 8px;
}

.primitives-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 8px;
}

.primitive-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  overflow: hidden;
}

.primitive-item:hover {
  background: #444;
  border-color: #777;
  transform: translateY(-1px);
}

.primitive-item:active {
  transform: translateY(0);
  background: #007acc;
  border-color: #0088dd;
}

.primitive-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 60px;
  background: #2a2a2a;
}

.primitive-icon {
  font-size: 24px;
  line-height: 1;
}

.primitive-info {
  padding: 8px 6px;
  text-align: center;
}

.primitive-name {
  font-size: 10px;
  font-weight: 500;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 移动端响应式 */
@media (max-width: 768px) {
  .primitives-list {
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 6px;
  }
  
  .primitive-preview {
    height: 50px;
  }
  
  .primitive-icon {
    font-size: 20px;
  }
  
  .primitive-name {
    font-size: 9px;
  }
  
  .section-title {
    font-size: 12px;
  }
}
</style>

</final_file_content>

IMPORTANT: For any future changes to this file, use the final_file_content shown above as your reference. This content reflects the current state of the file, including any auto-formatting (e.g., if you used single quotes but the formatter converted them to double quotes). Always base your SEARCH/REPLACE operations on this final version to ensure accuracy.


<environment_details>
# VSCode Visible Files
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/0
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/1
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/2
src/components/editor/AssetBrowser.vue

# VSCode Open Tabs
src/components/editor/AssetBrowser.vue

# Current Time
2025/8/6 下午5:55:30 (Asia/Shanghai, UTC+8:00)

# Context Window Usage
2,377 / 111.452K tokens used (2%)

# Current Mode
ACT MODE
</environment_details>

---

**Assistant:**

<thinking>
已完成 AssetBrowser.vue 的功能调整，上传模型和上传纹理按钮已固定为各自列表的第一项。根据项目规范，新增/删除文件无需修改 README.md，但涉及结构变更时仍需同步 README.md 的项目结构。此次仅为 UI 结构调整，无新增/删除文件，无需修改 README.md。任务已完成。
</thinking>

<attempt_completion>
<result>
已实现：上传模型文件按钮固定显示在模型列表第一项，上传纹理文件按钮固定显示在纹理列表第一项，无论列表有无数据均显示。AssetBrowser.vue 结构已调整，符合你的需求。
</result>
</attempt_completion>

---

**User:**

[attempt_completion] Result:
The user has provided feedback on the results. Consider their input to continue the task, and then attempt completion again.
<feedback>
上传功能的点击事件放到.upload-item-fixed上，去掉上传的button
</feedback>
<environment_details>
# VSCode Visible Files
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/0
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/1
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/2
src/components/editor/AssetBrowser.vue

# VSCode Open Tabs
src/components/editor/AssetBrowser.vue

# Current Time
2025/8/6 下午5:57:34 (Asia/Shanghai, UTC+8:00)

# Context Window Usage
168 / 111.452K tokens used (0%)

# Current Mode
ACT MODE
</environment_details>

---

**Assistant:**

<thinking>
用户反馈需要将上传功能的点击事件绑定到.upload-item-fixed容器上，并移除上传按钮。即：点击整个上传项即可触发上传，无需单独按钮。需分别调整模型和纹理上传项的结构和事件绑定。
</thinking>

<replace_in_file>
<path>src/components/editor/AssetBrowser.vue</path>
<diff>
------- SEARCH
<div class="asset-item model-item upload-item-fixed">
          <div class="asset-preview">
            <div class="preview-placeholder">
              <span class="placeholder-icon">⬆️</span>
            </div>
          </div>
          <div class="asset-info">
            <div class="asset-name" title="上传模型文件">上传模型文件</div>
            <div class="asset-actions">
              <button 
                @click.stop="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])"
                class="action-btn add-btn"
                title="上传模型文件"
              >
                <span class="icon">⬆️</span>
              </button>
            </div>
          </div>
        </div>
=======
<div class="asset-item model-item upload-item-fixed"
     @click="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])"
     title="上传模型文件">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">⬆️</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">上传模型文件</div>
  </div>
</div>
+++++++ REPLACE

------- SEARCH
<div class="asset-item texture-item upload-item-fixed">
          <div class="asset-preview">
            <div class="preview-placeholder">
              <span class="placeholder-icon">⬆️</span>
            </div>
          </div>
          <div class="asset-info">
            <div class="asset-name" title="上传纹理文件">上传纹理文件</div>
            <div class="asset-actions">
              <button 
                @click.stop="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])"
                class="action-btn add-btn"
                title="上传纹理文件"
              >
                <span class="icon">⬆️</span>
              </button>
            </div>
          </div>
        </div>
=======
<div class="asset-item texture-item upload-item-fixed"
     @click="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])"
     title="上传纹理文件">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">⬆️</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">上传纹理文件</div>
  </div>
</div>
+++++++ REPLACE
</diff>
</replace_in_file>

---

**User:**

[replace_in_file for 'src/components/editor/AssetBrowser.vue'] Result:
The content was successfully saved to src/components/editor/AssetBrowser.vue.

Here is the full, updated content of the file that was saved:

<final_file_content path="src/components/editor/AssetBrowser.vue">
<template>
  <div class="asset-browser">
    <!-- 拖拽上传区域 -->
    <div 
      v-if="dragState.isDragOver"
      class="drag-overlay"
      @dragenter="handleDragEnter"
      @dragover.prevent
      @dragleave="handleDragLeave"
      @drop="handleDrop"
    >
      <div class="drag-content">
        <span class="drag-icon">📥</span>
        <p>释放文件以上传</p>
      </div>
    </div>

    <!-- 上传进度 -->
    <div v-if="uploadState.isUploading" class="upload-progress">
      <div class="progress-header">
        <span>上传中... {{ uploadState.uploadProgress.toFixed(0) }}%</span>
      </div>
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          :style="{ width: uploadState.uploadProgress + '%' }"
        ></div>
      </div>
      <div class="upload-queue">
        <div 
          v-for="(item, index) in uploadState.uploadQueue" 
          :key="index"
          class="upload-item"
          :class="item.status"
        >
          <span class="item-name">{{ item.file.name }}</span>
          <span class="item-status">{{ getStatusText(item.status) }}</span>
        </div>
      </div>
    </div>

    <!-- 资源标签页 -->
    <div class="asset-tabs">
      <button 
        @click="activeTab = 'primitives'" 
        :class="['tab-btn', { active: activeTab === 'primitives' }]"
      >
        基础几何体
      </button>
      <button 
        @click="activeTab = 'models'" 
        :class="['tab-btn', { active: activeTab === 'models' }]"
      >
        3D模型 ({{ filteredModels.length }})
      </button>
      <button 
        @click="activeTab = 'textures'" 
        :class="['tab-btn', { active: activeTab === 'textures' }]"
      >
        纹理 ({{ filteredTextures.length }})
      </button>
    </div>

    <!-- 资源网格 -->
    <div class="asset-grid" 
         @dragenter="handleDragEnter"
         @dragover.prevent
         @dragleave="handleDragLeave"
         @drop="handleDrop">
      
      <!-- 基础几何体 -->
      <div v-if="activeTab === 'primitives'" class="primitives-grid">
        <div class="primitives-section">
          <h4 class="section-title">基础几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in basicPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">扩展几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in extendedPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">灯光</h4>
          <div class="primitives-list">
            <div 
              v-for="light in lightPrimitives" 
              :key="light.type"
              class="primitive-item"
              @click="addPrimitive(light.type)"
              :title="light.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ light.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ light.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">其他对象</h4>
          <div class="primitives-list">
            <div 
              v-for="other in otherPrimitives" 
              :key="other.type"
              class="primitive-item"
              @click="addPrimitive(other.type)"
              :title="other.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ other.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ other.name }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 3D模型 -->
<div v-if="activeTab === 'models'" class="models-grid">
        <!-- 固定上传模型按钮 -->
<div class="asset-item model-item upload-item-fixed"
     @click="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])"
     title="上传模型文件">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">⬆️</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">上传模型文件</div>
  </div>
</div>
        <!-- 渲染模型列表 -->
        <div 
          v-for="model in filteredModels" 
          :key="model.id"
          class="asset-item model-item"
          @click="selectModel(model)"
          @dblclick="addModelToScene(model.id)"
          :class="{ selected: selectedAssetId === model.id }"
        >
          <div class="asset-preview">
            <img 
              v-if="model.preview" 
              :src="model.preview" 
              :alt="model.name"
              class="preview-image"
            >
            <div v-else class="preview-placeholder">
              <span class="placeholder-icon">📦</span>
            </div>
            <button 
              @click.stop="toggleFavorite('model', model.id)"
              class="favorite-btn"
              :class="{ active: model.isFavorite }"
            >
              {{ model.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="model.name">{{ model.name }}</div>
            <div class="asset-meta">
              <span class="asset-type">{{ model.type }}</span>
              <span class="asset-size">{{ formatFileSize(model.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="addModelToScene(model.id)"
                class="action-btn add-btn"
                title="添加到场景"
              >
                <span class="icon">➕</span>
              </button>
              <button 
                @click.stop="showModelOptions(model)"
                class="action-btn options-btn"
                title="更多选项"
              >
                <span class="icon">⚙️</span>
              </button>
              <button 
                @click.stop="deleteAsset('model', model.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredModels.length === 0" class="empty-state">
          <p>没有找到3D模型</p>
        </div>
      </div>

      <!-- 纹理 -->
<div v-if="activeTab === 'textures'" class="textures-grid">
        <!-- 固定上传纹理按钮 -->
<div class="asset-item texture-item upload-item-fixed"
     @click="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])"
     title="上传纹理文件">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">⬆️</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">上传纹理文件</div>
  </div>
</div>
        <!-- 渲染纹理列表 -->
        <div 
          v-for="texture in filteredTextures" 
          :key="texture.id"
          class="asset-item texture-item"
          @click="selectTexture(texture)"
          :class="{ selected: selectedAssetId === texture.id }"
        >
          <div class="asset-preview">
            <img 
              :src="texture.preview" 
              :alt="texture.name"
              class="preview-image"
            >
            <button 
              @click.stop="toggleFavorite('texture', texture.id)"
              class="favorite-btn"
              :class="{ active: texture.isFavorite }"
            >
              {{ texture.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="texture.name">{{ texture.name }}</div>
            <div class="asset-meta">
              <span class="asset-resolution">{{ texture.width }}×{{ texture.height }}</span>
              <span class="asset-size">{{ formatFileSize(texture.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="applyTextureToSelected(texture)"
                class="action-btn apply-btn"
                title="应用到选中对象"
              >
                <span class="icon">🎨</span>
              </button>
              <button 
                @click.stop="deleteAsset('texture', texture.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredTextures.length === 0" class="empty-state">
          <p>没有找到纹理</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { ref, computed } from 'vue';
import { useAssets } from '../../composables/useAssets.js';
import { useObjectSelection } from '../../composables/useObjectSelection.js';
import { useScene } from '../../composables/useScene.js';

export default {
  name: 'AssetBrowser',
  /**
   * 资源浏览器组件
   * 提供模型、纹理、几何体的浏览与管理功能
   */
  setup() {
    const assets = useAssets();
    const objectSelection = useObjectSelection();
    const scene = useScene();
    
    // 本地状态
    const activeTab = ref('primitives');
    const selectedAssetId = ref(null);
    
    // 基础几何体数据
    const basicPrimitives = ref([
      {
        type: 'box',
        name: '立方体',
        icon: '⬜',
        description: '创建一个立方体几何体'
      },
      {
        type: 'sphere',
        name: '球体',
        icon: '⚪',
        description: '创建一个球体几何体'
      },
      {
        type: 'cylinder',
        name: '圆柱体',
        icon: '🥫',
        description: '创建一个圆柱体几何体'
      },
      {
        type: 'plane',
        name: '平面',
        icon: '▭',
        description: '创建一个平面几何体'
      },
      {
        type: 'cone',
        name: '圆锥体',
        icon: '🔺',
        description: '创建一个圆锥体几何体'
      },
      {
        type: 'torus',
        name: '圆环体',
        icon: '🍩',
        description: '创建一个圆环体几何体'
      }
    ]);

    // 扩展几何体数据
    const extendedPrimitives = ref([
      {
        type: 'dodecahedron',
        name: '十二面体',
        icon: '🎲',
        description: '创建一个十二面体几何体'
      },
      {
        type: 'icosahedron',
        name: '二十面体',
        icon: '💎',
        description: '创建一个二十面体几何体'
      },
      {
        type: 'octahedron',
        name: '八面体',
        icon: '🔸',
        description: '创建一个八面体几何体'
      },
      {
        type: 'tetrahedron',
        name: '四面体',
        icon: '🔻',
        description: '创建一个四面体几何体'
      },
      {
        type: 'ring',
        name: '环形',
        icon: '⭕',
        description: '创建一个环形几何体'
      },
      {
        type: 'tube',
        name: '管道',
        icon: '🌀',
        description: '创建一个管道几何体'
      }
    ]);

    // 灯光数据
    const lightPrimitives = ref([
      {
        type: 'directionalLight',
        name: '方向光',
        icon: '☀️',
        description: '创建一个方向光源'
      },
      {
        type: 'pointLight',
        name: '点光源',
        icon: '💡',
        description: '创建一个点光源'
      },
      {
        type: 'spotLight',
        name: '聚光灯',
        icon: '🔦',
        description: '创建一个聚光灯'
      },
      {
        type: 'ambientLight',
        name: '环境光',
        icon: '🌕',
        description: '创建一个环境光'
      },
      {
        type: 'hemisphereLight',
        name: '半球光',
        icon: '🌗',
        description: '创建一个半球光'
      }
    ]);

    // 其他对象数据
    const otherPrimitives = ref([
      {
        type: 'camera',
        name: '相机',
        icon: '📷',
        description: '创建一个透视相机'
      },
      {
        type: 'group',
        name: '空对象',
        icon: '📦',
        description: '创建一个空的组对象'
      },
      {
        type: 'text',
        name: '文本',
        icon: '📝',
        description: '创建一个3D文本对象'
      },
      {
        type: 'sprite',
        name: '精灵',
        icon: '🎭',
        description: '创建一个精灵对象'
      }
    ]);
    
    // 从assets composable获取状态
    const {
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      
      // 方法
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop
    } = assets;
    
    // 计算属性
    // categories、toggleSortOrder等已移除
    
    /**
     * 选中模型
     * @param {Object} model 模型对象
     */
    function selectModel(model) {
      selectedAssetId.value = model.id;
    }
    
    /**
     * 选中纹理
     * @param {Object} texture 纹理对象
     */
    function selectTexture(texture) {
      selectedAssetId.value = texture.id;
    }
    
    /**
     * 显示模型更多选项（待实现）
     * @param {Object} model 模型对象
     */
    function showModelOptions(model) {
      // TODO: 显示模型选项对话框
      console.log('显示模型选项:', model);
    }
    
    /**
     * 将纹理应用到选中的对象
     * @param {Object} texture 纹理对象
     */
    function applyTextureToSelected(texture) {
      const selectedObjects = objectSelection.selectedObjects.value;
      if (selectedObjects.length === 0) {
        alert('请先选择要应用纹理的对象');
        return;
      }
      
      selectedObjects.forEach(object => {
        if (object.material) {
          object.material.map = texture.texture;
          object.material.needsUpdate = true;
        }
      });
    }
    
    /**
     * 格式化文件大小
     * @param {number} bytes 字节数
     * @returns {string} 格式化结果
     */
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const sizes = ['B', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    /**
     * 获取上传状态文本
     * @param {string} status 状态码
     * @returns {string} 状态文本
     */
    function getStatusText(status) {
      const statusMap = {
        pending: '等待中',
        uploading: '上传中',
        completed: '已完成',
        failed: '失败'
      };
      return statusMap[status] || status;
    }

    // 添加几何体到场景
    /**
     * 添加几何体到场景
     * @param {string} type 几何体类型
     */
    function addPrimitive(type) {
      const position = [
        Math.random() * 4 - 2,
        Math.random() * 2,
        Math.random() * 4 - 2
      ];
      
      scene.createPrimitive(type, { position });
    }

    // 解构 selectAndUploadFiles 以便 setup 内和模板都能直接用
    const { selectAndUploadFiles } = assets;
    
    return {
      // 状态
      activeTab,
      selectedAssetId,
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      basicPrimitives,
      extendedPrimitives,
      lightPrimitives,
      otherPrimitives,
      
      // 方法
      selectModel,
      selectTexture,
      showModelOptions,
      applyTextureToSelected,
      formatFileSize,
      getStatusText,
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop,
      addPrimitive,
      selectAndUploadFiles
    };
  }
};
</script>

<style scoped>
.asset-browser {
  width: 100%;
  height: 100%;
  background: #2a2a2a;
  border-right: 1px solid #444;
  display: flex;
  flex-direction: column;
  color: #fff;
}

.browser-header {
  padding: 16px;
  border-bottom: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.browser-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.header-actions {
  display: flex;
  gap: 8px;
}

.upload-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
}

.upload-btn:hover {
  background: #0088dd;
}

.clear-btn {
  padding: 6px 8px;
  background: #d73a49;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.clear-btn:hover {
  background: #e85662;
}

.browser-filters {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
}

.search-box {
  position: relative;
  margin-bottom: 12px;
}

.search-input {
  width: 100%;
  padding: 8px 32px 8px 12px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.search-input:focus {
  outline: none;
  border-color: #007acc;
}

.search-icon {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
  font-size: 14px;
}

.filter-controls {
  display: flex;
  gap: 8px;
  align-items: center;
}

.category-select,
.sort-select {
  flex: 1;
  padding: 6px 8px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.sort-order-btn {
  padding: 6px 8px;
  background: #555;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.sort-order-btn:hover {
  background: #666;
}

.drag-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 122, 204, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.drag-content {
  text-align: center;
  color: #fff;
}

.drag-icon {
  font-size: 48px;
  display: block;
  margin-bottom: 16px;
}

.upload-progress {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
  background: #333;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  font-size: 12px;
}

.progress-bar {
  height: 4px;
  background: #555;
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 8px;
}

.progress-fill {
  height: 100%;
  background: #007acc;
  transition: width 0.3s;
}

.upload-queue {
  max-height: 120px;
  overflow-y: auto;
}

.upload-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
  font-size: 11px;
}

.upload-item.completed {
  color: #4caf50;
}

.upload-item.failed {
  color: #f44336;
}

.asset-tabs {
  display: flex;
  border-bottom: 1px solid #444;
}

.tab-btn {
  flex: 1;
  padding: 12px 16px;
  background: #333;
  border: none;
  border-bottom: 2px solid transparent;
  color: #aaa;
  font-size: 12px;
  cursor: pointer;
}

.tab-btn:hover {
  background: #444;
  color: #fff;
}

.tab-btn.active {
  background: #2a2a2a;
  border-bottom-color: #007acc;
  color: #fff;
}

.asset-grid {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.models-grid,
.textures-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
}

.asset-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}

.asset-item:hover {
  border-color: #777;
  transform: translateY(-2px);
}

.asset-item.selected {
  border-color: #007acc;
  box-shadow: 0 0 0 1px #007acc;
}

.asset-preview {
  position: relative;
  width: 100%;
  height: 80px;
  overflow: hidden;
}

.preview-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.preview-placeholder {
  width: 100%;
  height: 100%;
  background: #555;
  display: flex;
  align-items: center;
  justify-content: center;
}

.placeholder-icon {
  font-size: 24px;
  color: #888;
}

.favorite-btn {
  position: absolute;
  top: 4px;
  right: 4px;
  background: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  color: #fff;
  cursor: pointer;
  font-size: 12px;
}

.favorite-btn.active {
  color: #ffd700;
}

.asset-info {
  padding: 8px;
}

.asset-name {
  font-size: 11px;
  font-weight: 600;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.asset-meta {
  display: flex;
  justify-content: space-between;
  font-size: 9px;
  color: #aaa;
  margin-bottom: 8px;
}

.asset-actions {
  display: flex;
  gap: 4px;
}

.action-btn {
  flex: 1;
  padding: 4px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 10px;
}

.add-btn {
  background: #4caf50;
  color: #fff;
}

.apply-btn {
  background: #ff9800;
  color: #fff;
}

.options-btn {
  background: #555;
  color: #fff;
}

.delete-btn {
  background: #f44336;
  color: #fff;
}

.action-btn:hover {
  opacity: 0.8;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #aaa;
}

.upload-hint-btn {
  padding: 8px 16px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
  margin-top: 12px;
}

.upload-hint-btn:hover {
  background: #0088dd;
}

/* 几何体样式 */
.primitives-grid {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.primitives-section {
  margin-bottom: 16px;
}

.section-title {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  border-bottom: 1px solid #555;
  padding-bottom: 8px;
}

.primitives-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 8px;
}

.primitive-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  overflow: hidden;
}

.primitive-item:hover {
  background: #444;
  border-color: #777;
  transform: translateY(-1px);
}

.primitive-item:active {
  transform: translateY(0);
  background: #007acc;
  border-color: #0088dd;
}

.primitive-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 60px;
  background: #2a2a2a;
}

.primitive-icon {
  font-size: 24px;
  line-height: 1;
}

.primitive-info {
  padding: 8px 6px;
  text-align: center;
}

.primitive-name {
  font-size: 10px;
  font-weight: 500;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 移动端响应式 */
@media (max-width: 768px) {
  .primitives-list {
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 6px;
  }
  
  .primitive-preview {
    height: 50px;
  }
  
  .primitive-icon {
    font-size: 20px;
  }
  
  .primitive-name {
    font-size: 9px;
  }
  
  .section-title {
    font-size: 12px;
  }
}
</style>

</final_file_content>

IMPORTANT: For any future changes to this file, use the final_file_content shown above as your reference. This content reflects the current state of the file, including any auto-formatting (e.g., if you used single quotes but the formatter converted them to double quotes). Always base your SEARCH/REPLACE operations on this final version to ensure accuracy.


<environment_details>
# VSCode Visible Files
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/0
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/1
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/2
src/components/editor/AssetBrowser.vue

# VSCode Open Tabs
src/components/editor/AssetBrowser.vue

# Current Time
2025/8/6 下午5:57:56 (Asia/Shanghai, UTC+8:00)

# Context Window Usage
686 / 111.452K tokens used (1%)

# Current Mode
ACT MODE
</environment_details>

---

**Assistant:**

<thinking>
已根据反馈将上传项的点击事件绑定到.upload-item-fixed容器，并移除了上传按钮。无新增或删除文件，无需修改README.md。功能已完全符合需求。
</thinking>

<attempt_completion>
<result>
上传模型和上传纹理的点击事件已绑定到.upload-item-fixed容器，已移除上传按钮。现在点击整个上传项即可触发上传，界面更简洁，符合你的要求。
</result>
</attempt_completion>

---

**User:**

[attempt_completion] Result:
The user has provided feedback on the results. Consider their input to continue the task, and then attempt completion again.
<feedback>
“上传模型文件”“上传纹理文件”的文字居中
</feedback>
<environment_details>
# VSCode Visible Files
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/0
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/1
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/2
src/components/editor/AssetBrowser.vue

# VSCode Open Tabs
src/components/editor/AssetBrowser.vue

# Current Time
2025/8/6 下午5:58:23 (Asia/Shanghai, UTC+8:00)

# Context Window Usage
143 / 111.452K tokens used (0%)

# Current Mode
ACT MODE
</environment_details>

---

**Assistant:**

<thinking>
用户反馈需要让“上传模型文件”“上传纹理文件”的文字居中显示。只需为.upload-item-fixed下的.asset-info或.asset-name添加居中样式。可通过CSS选择器调整。
</thinking>

<replace_in_file>
<path>src/components/editor/AssetBrowser.vue</path>
<diff>
------- SEARCH
.asset-info {
  padding: 8px;
}
=======
.asset-info {
  padding: 8px;
}
.upload-item-fixed .asset-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.upload-item-fixed .asset-name {
  text-align: center;
  width: 100%;
}
+++++++ REPLACE
</diff>
</replace_in_file>

---

**User:**

[replace_in_file for 'src/components/editor/AssetBrowser.vue'] Result:
The content was successfully saved to src/components/editor/AssetBrowser.vue.

Here is the full, updated content of the file that was saved:

<final_file_content path="src/components/editor/AssetBrowser.vue">
<template>
  <div class="asset-browser">
    <!-- 拖拽上传区域 -->
    <div 
      v-if="dragState.isDragOver"
      class="drag-overlay"
      @dragenter="handleDragEnter"
      @dragover.prevent
      @dragleave="handleDragLeave"
      @drop="handleDrop"
    >
      <div class="drag-content">
        <span class="drag-icon">📥</span>
        <p>释放文件以上传</p>
      </div>
    </div>

    <!-- 上传进度 -->
    <div v-if="uploadState.isUploading" class="upload-progress">
      <div class="progress-header">
        <span>上传中... {{ uploadState.uploadProgress.toFixed(0) }}%</span>
      </div>
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          :style="{ width: uploadState.uploadProgress + '%' }"
        ></div>
      </div>
      <div class="upload-queue">
        <div 
          v-for="(item, index) in uploadState.uploadQueue" 
          :key="index"
          class="upload-item"
          :class="item.status"
        >
          <span class="item-name">{{ item.file.name }}</span>
          <span class="item-status">{{ getStatusText(item.status) }}</span>
        </div>
      </div>
    </div>

    <!-- 资源标签页 -->
    <div class="asset-tabs">
      <button 
        @click="activeTab = 'primitives'" 
        :class="['tab-btn', { active: activeTab === 'primitives' }]"
      >
        基础几何体
      </button>
      <button 
        @click="activeTab = 'models'" 
        :class="['tab-btn', { active: activeTab === 'models' }]"
      >
        3D模型 ({{ filteredModels.length }})
      </button>
      <button 
        @click="activeTab = 'textures'" 
        :class="['tab-btn', { active: activeTab === 'textures' }]"
      >
        纹理 ({{ filteredTextures.length }})
      </button>
    </div>

    <!-- 资源网格 -->
    <div class="asset-grid" 
         @dragenter="handleDragEnter"
         @dragover.prevent
         @dragleave="handleDragLeave"
         @drop="handleDrop">
      
      <!-- 基础几何体 -->
      <div v-if="activeTab === 'primitives'" class="primitives-grid">
        <div class="primitives-section">
          <h4 class="section-title">基础几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in basicPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">扩展几何体</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in extendedPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">灯光</h4>
          <div class="primitives-list">
            <div 
              v-for="light in lightPrimitives" 
              :key="light.type"
              class="primitive-item"
              @click="addPrimitive(light.type)"
              :title="light.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ light.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ light.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">其他对象</h4>
          <div class="primitives-list">
            <div 
              v-for="other in otherPrimitives" 
              :key="other.type"
              class="primitive-item"
              @click="addPrimitive(other.type)"
              :title="other.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ other.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ other.name }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 3D模型 -->
<div v-if="activeTab === 'models'" class="models-grid">
        <!-- 固定上传模型按钮 -->
<div class="asset-item model-item upload-item-fixed"
     @click="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])"
     title="上传模型文件">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">⬆️</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">上传模型文件</div>
  </div>
</div>
        <!-- 渲染模型列表 -->
        <div 
          v-for="model in filteredModels" 
          :key="model.id"
          class="asset-item model-item"
          @click="selectModel(model)"
          @dblclick="addModelToScene(model.id)"
          :class="{ selected: selectedAssetId === model.id }"
        >
          <div class="asset-preview">
            <img 
              v-if="model.preview" 
              :src="model.preview" 
              :alt="model.name"
              class="preview-image"
            >
            <div v-else class="preview-placeholder">
              <span class="placeholder-icon">📦</span>
            </div>
            <button 
              @click.stop="toggleFavorite('model', model.id)"
              class="favorite-btn"
              :class="{ active: model.isFavorite }"
            >
              {{ model.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="model.name">{{ model.name }}</div>
            <div class="asset-meta">
              <span class="asset-type">{{ model.type }}</span>
              <span class="asset-size">{{ formatFileSize(model.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="addModelToScene(model.id)"
                class="action-btn add-btn"
                title="添加到场景"
              >
                <span class="icon">➕</span>
              </button>
              <button 
                @click.stop="showModelOptions(model)"
                class="action-btn options-btn"
                title="更多选项"
              >
                <span class="icon">⚙️</span>
              </button>
              <button 
                @click.stop="deleteAsset('model', model.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredModels.length === 0" class="empty-state">
          <p>没有找到3D模型</p>
        </div>
      </div>

      <!-- 纹理 -->
<div v-if="activeTab === 'textures'" class="textures-grid">
        <!-- 固定上传纹理按钮 -->
<div class="asset-item texture-item upload-item-fixed"
     @click="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])"
     title="上传纹理文件">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">⬆️</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">上传纹理文件</div>
  </div>
</div>
        <!-- 渲染纹理列表 -->
        <div 
          v-for="texture in filteredTextures" 
          :key="texture.id"
          class="asset-item texture-item"
          @click="selectTexture(texture)"
          :class="{ selected: selectedAssetId === texture.id }"
        >
          <div class="asset-preview">
            <img 
              :src="texture.preview" 
              :alt="texture.name"
              class="preview-image"
            >
            <button 
              @click.stop="toggleFavorite('texture', texture.id)"
              class="favorite-btn"
              :class="{ active: texture.isFavorite }"
            >
              {{ texture.isFavorite ? '⭐' : '☆' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="texture.name">{{ texture.name }}</div>
            <div class="asset-meta">
              <span class="asset-resolution">{{ texture.width }}×{{ texture.height }}</span>
              <span class="asset-size">{{ formatFileSize(texture.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="applyTextureToSelected(texture)"
                class="action-btn apply-btn"
                title="应用到选中对象"
              >
                <span class="icon">🎨</span>
              </button>
              <button 
                @click.stop="deleteAsset('texture', texture.id)"
                class="action-btn delete-btn"
                title="删除"
              >
                <span class="icon">🗑️</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredTextures.length === 0" class="empty-state">
          <p>没有找到纹理</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { ref, computed } from 'vue';
import { useAssets } from '../../composables/useAssets.js';
import { useObjectSelection } from '../../composables/useObjectSelection.js';
import { useScene } from '../../composables/useScene.js';

export default {
  name: 'AssetBrowser',
  /**
   * 资源浏览器组件
   * 提供模型、纹理、几何体的浏览与管理功能
   */
  setup() {
    const assets = useAssets();
    const objectSelection = useObjectSelection();
    const scene = useScene();
    
    // 本地状态
    const activeTab = ref('primitives');
    const selectedAssetId = ref(null);
    
    // 基础几何体数据
    const basicPrimitives = ref([
      {
        type: 'box',
        name: '立方体',
        icon: '⬜',
        description: '创建一个立方体几何体'
      },
      {
        type: 'sphere',
        name: '球体',
        icon: '⚪',
        description: '创建一个球体几何体'
      },
      {
        type: 'cylinder',
        name: '圆柱体',
        icon: '🥫',
        description: '创建一个圆柱体几何体'
      },
      {
        type: 'plane',
        name: '平面',
        icon: '▭',
        description: '创建一个平面几何体'
      },
      {
        type: 'cone',
        name: '圆锥体',
        icon: '🔺',
        description: '创建一个圆锥体几何体'
      },
      {
        type: 'torus',
        name: '圆环体',
        icon: '🍩',
        description: '创建一个圆环体几何体'
      }
    ]);

    // 扩展几何体数据
    const extendedPrimitives = ref([
      {
        type: 'dodecahedron',
        name: '十二面体',
        icon: '🎲',
        description: '创建一个十二面体几何体'
      },
      {
        type: 'icosahedron',
        name: '二十面体',
        icon: '💎',
        description: '创建一个二十面体几何体'
      },
      {
        type: 'octahedron',
        name: '八面体',
        icon: '🔸',
        description: '创建一个八面体几何体'
      },
      {
        type: 'tetrahedron',
        name: '四面体',
        icon: '🔻',
        description: '创建一个四面体几何体'
      },
      {
        type: 'ring',
        name: '环形',
        icon: '⭕',
        description: '创建一个环形几何体'
      },
      {
        type: 'tube',
        name: '管道',
        icon: '🌀',
        description: '创建一个管道几何体'
      }
    ]);

    // 灯光数据
    const lightPrimitives = ref([
      {
        type: 'directionalLight',
        name: '方向光',
        icon: '☀️',
        description: '创建一个方向光源'
      },
      {
        type: 'pointLight',
        name: '点光源',
        icon: '💡',
        description: '创建一个点光源'
      },
      {
        type: 'spotLight',
        name: '聚光灯',
        icon: '🔦',
        description: '创建一个聚光灯'
      },
      {
        type: 'ambientLight',
        name: '环境光',
        icon: '🌕',
        description: '创建一个环境光'
      },
      {
        type: 'hemisphereLight',
        name: '半球光',
        icon: '🌗',
        description: '创建一个半球光'
      }
    ]);

    // 其他对象数据
    const otherPrimitives = ref([
      {
        type: 'camera',
        name: '相机',
        icon: '📷',
        description: '创建一个透视相机'
      },
      {
        type: 'group',
        name: '空对象',
        icon: '📦',
        description: '创建一个空的组对象'
      },
      {
        type: 'text',
        name: '文本',
        icon: '📝',
        description: '创建一个3D文本对象'
      },
      {
        type: 'sprite',
        name: '精灵',
        icon: '🎭',
        description: '创建一个精灵对象'
      }
    ]);
    
    // 从assets composable获取状态
    const {
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      
      // 方法
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop
    } = assets;
    
    // 计算属性
    // categories、toggleSortOrder等已移除
    
    /**
     * 选中模型
     * @param {Object} model 模型对象
     */
    function selectModel(model) {
      selectedAssetId.value = model.id;
    }
    
    /**
     * 选中纹理
     * @param {Object} texture 纹理对象
     */
    function selectTexture(texture) {
      selectedAssetId.value = texture.id;
    }
    
    /**
     * 显示模型更多选项（待实现）
     * @param {Object} model 模型对象
     */
    function showModelOptions(model) {
      // TODO: 显示模型选项对话框
      console.log('显示模型选项:', model);
    }
    
    /**
     * 将纹理应用到选中的对象
     * @param {Object} texture 纹理对象
     */
    function applyTextureToSelected(texture) {
      const selectedObjects = objectSelection.selectedObjects.value;
      if (selectedObjects.length === 0) {
        alert('请先选择要应用纹理的对象');
        return;
      }
      
      selectedObjects.forEach(object => {
        if (object.material) {
          object.material.map = texture.texture;
          object.material.needsUpdate = true;
        }
      });
    }
    
    /**
     * 格式化文件大小
     * @param {number} bytes 字节数
     * @returns {string} 格式化结果
     */
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const sizes = ['B', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    /**
     * 获取上传状态文本
     * @param {string} status 状态码
     * @returns {string} 状态文本
     */
    function getStatusText(status) {
      const statusMap = {
        pending: '等待中',
        uploading: '上传中',
        completed: '已完成',
        failed: '失败'
      };
      return statusMap[status] || status;
    }

    // 添加几何体到场景
    /**
     * 添加几何体到场景
     * @param {string} type 几何体类型
     */
    function addPrimitive(type) {
      const position = [
        Math.random() * 4 - 2,
        Math.random() * 2,
        Math.random() * 4 - 2
      ];
      
      scene.createPrimitive(type, { position });
    }

    // 解构 selectAndUploadFiles 以便 setup 内和模板都能直接用
    const { selectAndUploadFiles } = assets;
    
    return {
      // 状态
      activeTab,
      selectedAssetId,
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      basicPrimitives,
      extendedPrimitives,
      lightPrimitives,
      otherPrimitives,
      
      // 方法
      selectModel,
      selectTexture,
      showModelOptions,
      applyTextureToSelected,
      formatFileSize,
      getStatusText,
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop,
      addPrimitive,
      selectAndUploadFiles
    };
  }
};
</script>

<style scoped>
.asset-browser {
  width: 100%;
  height: 100%;
  background: #2a2a2a;
  border-right: 1px solid #444;
  display: flex;
  flex-direction: column;
  color: #fff;
}

.browser-header {
  padding: 16px;
  border-bottom: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.browser-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.header-actions {
  display: flex;
  gap: 8px;
}

.upload-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
}

.upload-btn:hover {
  background: #0088dd;
}

.clear-btn {
  padding: 6px 8px;
  background: #d73a49;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.clear-btn:hover {
  background: #e85662;
}

.browser-filters {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
}

.search-box {
  position: relative;
  margin-bottom: 12px;
}

.search-input {
  width: 100%;
  padding: 8px 32px 8px 12px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.search-input:focus {
  outline: none;
  border-color: #007acc;
}

.search-icon {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
  font-size: 14px;
}

.filter-controls {
  display: flex;
  gap: 8px;
  align-items: center;
}

.category-select,
.sort-select {
  flex: 1;
  padding: 6px 8px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.sort-order-btn {
  padding: 6px 8px;
  background: #555;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.sort-order-btn:hover {
  background: #666;
}

.drag-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 122, 204, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.drag-content {
  text-align: center;
  color: #fff;
}

.drag-icon {
  font-size: 48px;
  display: block;
  margin-bottom: 16px;
}

.upload-progress {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
  background: #333;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  font-size: 12px;
}

.progress-bar {
  height: 4px;
  background: #555;
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 8px;
}

.progress-fill {
  height: 100%;
  background: #007acc;
  transition: width 0.3s;
}

.upload-queue {
  max-height: 120px;
  overflow-y: auto;
}

.upload-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
  font-size: 11px;
}

.upload-item.completed {
  color: #4caf50;
}

.upload-item.failed {
  color: #f44336;
}

.asset-tabs {
  display: flex;
  border-bottom: 1px solid #444;
}

.tab-btn {
  flex: 1;
  padding: 12px 16px;
  background: #333;
  border: none;
  border-bottom: 2px solid transparent;
  color: #aaa;
  font-size: 12px;
  cursor: pointer;
}

.tab-btn:hover {
  background: #444;
  color: #fff;
}

.tab-btn.active {
  background: #2a2a2a;
  border-bottom-color: #007acc;
  color: #fff;
}

.asset-grid {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.models-grid,
.textures-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
}

.asset-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}

.asset-item:hover {
  border-color: #777;
  transform: translateY(-2px);
}

.asset-item.selected {
  border-color: #007acc;
  box-shadow: 0 0 0 1px #007acc;
}

.asset-preview {
  position: relative;
  width: 100%;
  height: 80px;
  overflow: hidden;
}

.preview-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.preview-placeholder {
  width: 100%;
  height: 100%;
  background: #555;
  display: flex;
  align-items: center;
  justify-content: center;
}

.placeholder-icon {
  font-size: 24px;
  color: #888;
}

.favorite-btn {
  position: absolute;
  top: 4px;
  right: 4px;
  background: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  color: #fff;
  cursor: pointer;
  font-size: 12px;
}

.favorite-btn.active {
  color: #ffd700;
}

.asset-info {
  padding: 8px;
}
.upload-item-fixed .asset-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.upload-item-fixed .asset-name {
  text-align: center;
  width: 100%;
}

.asset-name {
  font-size: 11px;
  font-weight: 600;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.asset-meta {
  display: flex;
  justify-content: space-between;
  font-size: 9px;
  color: #aaa;
  margin-bottom: 8px;
}

.asset-actions {
  display: flex;
  gap: 4px;
}

.action-btn {
  flex: 1;
  padding: 4px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 10px;
}

.add-btn {
  background: #4caf50;
  color: #fff;
}

.apply-btn {
  background: #ff9800;
  color: #fff;
}

.options-btn {
  background: #555;
  color: #fff;
}

.delete-btn {
  background: #f44336;
  color: #fff;
}

.action-btn:hover {
  opacity: 0.8;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #aaa;
}

.upload-hint-btn {
  padding: 8px 16px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
  margin-top: 12px;
}

.upload-hint-btn:hover {
  background: #0088dd;
}

/* 几何体样式 */
.primitives-grid {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.primitives-section {
  margin-bottom: 16px;
}

.section-title {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  border-bottom: 1px solid #555;
  padding-bottom: 8px;
}

.primitives-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 8px;
}

.primitive-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  overflow: hidden;
}

.primitive-item:hover {
  background: #444;
  border-color: #777;
  transform: translateY(-1px);
}

.primitive-item:active {
  transform: translateY(0);
  background: #007acc;
  border-color: #0088dd;
}

.primitive-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 60px;
  background: #2a2a2a;
}

.primitive-icon {
  font-size: 24px;
  line-height: 1;
}

.primitive-info {
  padding: 8px 6px;
  text-align: center;
}

.primitive-name {
  font-size: 10px;
  font-weight: 500;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* 移动端响应式 */
@media (max-width: 768px) {
  .primitives-list {
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 6px;
  }
  
  .primitive-preview {
    height: 50px;
  }
  
  .primitive-icon {
    font-size: 20px;
  }
  
  .primitive-name {
    font-size: 9px;
  }
  
  .section-title {
    font-size: 12px;
  }
}
</style>

</final_file_content>

IMPORTANT: For any future changes to this file, use the final_file_content shown above as your reference. This content reflects the current state of the file, including any auto-formatting (e.g., if you used single quotes but the formatter converted them to double quotes). Always base your SEARCH/REPLACE operations on this final version to ensure accuracy.


<environment_details>
# VSCode Visible Files
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/0
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/1
C:/response_9d24c334-8dec-41c2-a3e0-32eb019f545c/2
src/components/editor/AssetBrowser.vue

# VSCode Open Tabs
src/components/editor/AssetBrowser.vue

# Current Time
2025/8/6 下午5:58:53 (Asia/Shanghai, UTC+8:00)

# Context Window Usage
210 / 111.452K tokens used (0%)

# Current Mode
ACT MODE
</environment_details>

---

**Assistant:**

<thinking>
已将“上传模型文件”“上传纹理文件”文字居中显示，样式已加到.upload-item-fixed下的.asset-info和.asset-name。无新增或删除文件，无需修改README.md。所有需求已完成。
</thinking>

<attempt_completion>
<result>
“上传模型文件”“上传纹理文件”文字已居中显示，上传项点击区域和样式均已优化，完全符合你的要求。
</result>
</attempt_completion>

