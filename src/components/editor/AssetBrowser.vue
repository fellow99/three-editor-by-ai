<template>
  <div class="asset-browser">
    <!-- æ‹–æ‹½ä¸Šä¼ åŒºåŸŸ -->
    <div 
      v-if="dragState.isDragOver"
      class="drag-overlay"
      @dragenter="handleDragEnter"
      @dragover.prevent
      @dragleave="handleDragLeave"
      @drop="handleDrop"
    >
      <div class="drag-content">
        <span class="drag-icon">ğŸ“¥</span>
        <p>é‡Šæ”¾æ–‡ä»¶ä»¥ä¸Šä¼ </p>
      </div>
    </div>

    <!-- ä¸Šä¼ è¿›åº¦ -->
    <div v-if="uploadState.isUploading" class="upload-progress">
      <div class="progress-header">
        <span>ä¸Šä¼ ä¸­... {{ uploadState.uploadProgress.toFixed(0) }}%</span>
      </div>
      <div class="progress-bar">
        <div 
          class="progress-fill" 
          :style="{ width: uploadState.uploadProgress + '%' }"
        ></div>
      </div>
      <div class="upload-queue">
        <div 
          v-for="(item, index) in uploadState.uploadQueue" 
          :key="index"
          class="upload-item"
          :class="item.status"
        >
          <span class="item-name">{{ item.file.name }}</span>
          <span class="item-status">{{ getStatusText(item.status) }}</span>
        </div>
      </div>
    </div>

    <!-- èµ„æºæ ‡ç­¾é¡µ -->
    <div class="asset-tabs">
      <button 
        @click="activeTab = 'primitives'" 
        :class="['tab-btn', { active: activeTab === 'primitives' }]"
      >
        åŸºç¡€å‡ ä½•ä½“
      </button>
      <button 
        @click="activeTab = 'models'" 
        :class="['tab-btn', { active: activeTab === 'models' }]"
      >
        3Dæ¨¡å‹ ({{ filteredModels.length }})
      </button>
      <button 
        @click="activeTab = 'textures'" 
        :class="['tab-btn', { active: activeTab === 'textures' }]"
      >
        çº¹ç† ({{ filteredTextures.length }})
      </button>
    </div>

    <!-- èµ„æºç½‘æ ¼ -->
    <div class="asset-grid" 
         @dragenter="handleDragEnter"
         @dragover.prevent
         @dragleave="handleDragLeave"
         @drop="handleDrop">
      
      <!-- åŸºç¡€å‡ ä½•ä½“ -->
      <div v-if="activeTab === 'primitives'" class="primitives-grid">
        <div class="primitives-section">
          <h4 class="section-title">åŸºç¡€å‡ ä½•ä½“</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in basicPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">æ‰©å±•å‡ ä½•ä½“</h4>
          <div class="primitives-list">
            <div 
              v-for="primitive in extendedPrimitives" 
              :key="primitive.type"
              class="primitive-item"
              @click="addPrimitive(primitive.type)"
              :title="primitive.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ primitive.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ primitive.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">ç¯å…‰</h4>
          <div class="primitives-list">
            <div 
              v-for="light in lightPrimitives" 
              :key="light.type"
              class="primitive-item"
              @click="addPrimitive(light.type)"
              :title="light.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ light.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ light.name }}</div>
              </div>
            </div>
          </div>
        </div>

        <div class="primitives-section">
          <h4 class="section-title">å…¶ä»–å¯¹è±¡</h4>
          <div class="primitives-list">
            <div 
              v-for="other in otherPrimitives" 
              :key="other.type"
              class="primitive-item"
              @click="addPrimitive(other.type)"
              :title="other.description"
            >
              <div class="primitive-preview">
                <span class="primitive-icon">{{ other.icon }}</span>
              </div>
              <div class="primitive-info">
                <div class="primitive-name">{{ other.name }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 3Dæ¨¡å‹ -->
<div v-if="activeTab === 'models'" class="models-grid">
        <!-- å›ºå®šä¸Šä¼ æ¨¡å‹æŒ‰é’® -->
<div class="asset-item model-item upload-item-fixed"
     @click="selectAndUploadFiles(['.gltf', '.glb', '.obj', '.fbx'])"
     title="ä¸Šä¼ æ¨¡å‹æ–‡ä»¶">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">â¬†ï¸</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">ä¸Šä¼ æ¨¡å‹æ–‡ä»¶</div>
  </div>
</div>
        <!-- æ¸²æŸ“æ¨¡å‹åˆ—è¡¨ -->
        <div 
          v-for="model in filteredModels" 
          :key="model.id"
          class="asset-item model-item"
          @click="selectModel(model)"
          @dblclick="addModelToScene(model.id)"
          :class="{ selected: selectedAssetId === model.id }"
        >
          <div class="asset-preview">
            <img 
              v-if="model.preview" 
              :src="model.preview" 
              :alt="model.name"
              class="preview-image"
            >
            <div v-else class="preview-placeholder">
              <span class="placeholder-icon">ğŸ“¦</span>
            </div>
            <button 
              @click.stop="toggleFavorite('model', model.id)"
              class="favorite-btn"
              :class="{ active: model.isFavorite }"
            >
              {{ model.isFavorite ? 'â­' : 'â˜†' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="model.name">{{ model.name }}</div>
            <div class="asset-meta">
              <span class="asset-type">{{ model.type }}</span>
              <span class="asset-size">{{ formatFileSize(model.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="addModelToScene(model.id)"
                class="action-btn add-btn"
                title="æ·»åŠ åˆ°åœºæ™¯"
              >
                <span class="icon">â•</span>
              </button>
              <button 
                @click.stop="showModelOptions(model)"
                class="action-btn options-btn"
                title="æ›´å¤šé€‰é¡¹"
              >
                <span class="icon">âš™ï¸</span>
              </button>
              <button 
                @click.stop="deleteAsset('model', model.id)"
                class="action-btn delete-btn"
                title="åˆ é™¤"
              >
                <span class="icon">ğŸ—‘ï¸</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredModels.length === 0" class="empty-state">
          <p>æ²¡æœ‰æ‰¾åˆ°3Dæ¨¡å‹</p>
        </div>
      </div>

      <!-- çº¹ç† -->
<div v-if="activeTab === 'textures'" class="textures-grid">
        <!-- å›ºå®šä¸Šä¼ çº¹ç†æŒ‰é’® -->
<div class="asset-item texture-item upload-item-fixed"
     @click="selectAndUploadFiles(['.jpg', '.jpeg', '.png', '.bmp', '.gif'])"
     title="ä¸Šä¼ çº¹ç†æ–‡ä»¶">
  <div class="asset-preview">
    <div class="preview-placeholder">
      <span class="placeholder-icon">â¬†ï¸</span>
    </div>
  </div>
  <div class="asset-info">
    <div class="asset-name">ä¸Šä¼ çº¹ç†æ–‡ä»¶</div>
  </div>
</div>
        <!-- æ¸²æŸ“çº¹ç†åˆ—è¡¨ -->
        <div 
          v-for="texture in filteredTextures" 
          :key="texture.id"
          class="asset-item texture-item"
          @click="selectTexture(texture)"
          :class="{ selected: selectedAssetId === texture.id }"
        >
          <div class="asset-preview">
            <img 
              :src="texture.preview" 
              :alt="texture.name"
              class="preview-image"
            >
            <button 
              @click.stop="toggleFavorite('texture', texture.id)"
              class="favorite-btn"
              :class="{ active: texture.isFavorite }"
            >
              {{ texture.isFavorite ? 'â­' : 'â˜†' }}
            </button>
          </div>
          
          <div class="asset-info">
            <div class="asset-name" :title="texture.name">{{ texture.name }}</div>
            <div class="asset-meta">
              <span class="asset-resolution">{{ texture.width }}Ã—{{ texture.height }}</span>
              <span class="asset-size">{{ formatFileSize(texture.size) }}</span>
            </div>
            
            <div class="asset-actions">
              <button 
                @click.stop="applyTextureToSelected(texture)"
                class="action-btn apply-btn"
                title="åº”ç”¨åˆ°é€‰ä¸­å¯¹è±¡"
              >
                <span class="icon">ğŸ¨</span>
              </button>
              <button 
                @click.stop="deleteAsset('texture', texture.id)"
                class="action-btn delete-btn"
                title="åˆ é™¤"
              >
                <span class="icon">ğŸ—‘ï¸</span>
              </button>
            </div>
          </div>
        </div>
        <div v-if="filteredTextures.length === 0" class="empty-state">
          <p>æ²¡æœ‰æ‰¾åˆ°çº¹ç†</p>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import { ref, computed } from 'vue';
import { useAssets } from '../../composables/useAssets.js';
import { useObjectSelection } from '../../composables/useObjectSelection.js';
import { useScene } from '../../composables/useScene.js';

export default {
  name: 'AssetBrowser',
  /**
   * èµ„æºæµè§ˆå™¨ç»„ä»¶
   * æä¾›æ¨¡å‹ã€çº¹ç†ã€å‡ ä½•ä½“çš„æµè§ˆä¸ç®¡ç†åŠŸèƒ½
   */
  setup() {
    const assets = useAssets();
    const objectSelection = useObjectSelection();
    const scene = useScene();
    
    // æœ¬åœ°çŠ¶æ€
    const activeTab = ref('primitives');
    const selectedAssetId = ref(null);
    
    // åŸºç¡€å‡ ä½•ä½“æ•°æ®
    const basicPrimitives = ref([
      {
        type: 'box',
        name: 'ç«‹æ–¹ä½“',
        icon: 'â¬œ',
        description: 'åˆ›å»ºä¸€ä¸ªç«‹æ–¹ä½“å‡ ä½•ä½“'
      },
      {
        type: 'sphere',
        name: 'çƒä½“',
        icon: 'âšª',
        description: 'åˆ›å»ºä¸€ä¸ªçƒä½“å‡ ä½•ä½“'
      },
      {
        type: 'cylinder',
        name: 'åœ†æŸ±ä½“',
        icon: 'ğŸ¥«',
        description: 'åˆ›å»ºä¸€ä¸ªåœ†æŸ±ä½“å‡ ä½•ä½“'
      },
      {
        type: 'plane',
        name: 'å¹³é¢',
        icon: 'â–­',
        description: 'åˆ›å»ºä¸€ä¸ªå¹³é¢å‡ ä½•ä½“'
      },
      {
        type: 'cone',
        name: 'åœ†é”¥ä½“',
        icon: 'ğŸ”º',
        description: 'åˆ›å»ºä¸€ä¸ªåœ†é”¥ä½“å‡ ä½•ä½“'
      },
      {
        type: 'torus',
        name: 'åœ†ç¯ä½“',
        icon: 'ğŸ©',
        description: 'åˆ›å»ºä¸€ä¸ªåœ†ç¯ä½“å‡ ä½•ä½“'
      }
    ]);

    // æ‰©å±•å‡ ä½•ä½“æ•°æ®
    const extendedPrimitives = ref([
      {
        type: 'dodecahedron',
        name: 'åäºŒé¢ä½“',
        icon: 'ğŸ²',
        description: 'åˆ›å»ºä¸€ä¸ªåäºŒé¢ä½“å‡ ä½•ä½“'
      },
      {
        type: 'icosahedron',
        name: 'äºŒåé¢ä½“',
        icon: 'ğŸ’',
        description: 'åˆ›å»ºä¸€ä¸ªäºŒåé¢ä½“å‡ ä½•ä½“'
      },
      {
        type: 'octahedron',
        name: 'å…«é¢ä½“',
        icon: 'ğŸ”¸',
        description: 'åˆ›å»ºä¸€ä¸ªå…«é¢ä½“å‡ ä½•ä½“'
      },
      {
        type: 'tetrahedron',
        name: 'å››é¢ä½“',
        icon: 'ğŸ”»',
        description: 'åˆ›å»ºä¸€ä¸ªå››é¢ä½“å‡ ä½•ä½“'
      },
      {
        type: 'ring',
        name: 'ç¯å½¢',
        icon: 'â­•',
        description: 'åˆ›å»ºä¸€ä¸ªç¯å½¢å‡ ä½•ä½“'
      },
      {
        type: 'tube',
        name: 'ç®¡é“',
        icon: 'ğŸŒ€',
        description: 'åˆ›å»ºä¸€ä¸ªç®¡é“å‡ ä½•ä½“'
      }
    ]);

    // ç¯å…‰æ•°æ®
    const lightPrimitives = ref([
      {
        type: 'directionalLight',
        name: 'æ–¹å‘å…‰',
        icon: 'â˜€ï¸',
        description: 'åˆ›å»ºä¸€ä¸ªæ–¹å‘å…‰æº'
      },
      {
        type: 'pointLight',
        name: 'ç‚¹å…‰æº',
        icon: 'ğŸ’¡',
        description: 'åˆ›å»ºä¸€ä¸ªç‚¹å…‰æº'
      },
      {
        type: 'spotLight',
        name: 'èšå…‰ç¯',
        icon: 'ğŸ”¦',
        description: 'åˆ›å»ºä¸€ä¸ªèšå…‰ç¯'
      },
      {
        type: 'ambientLight',
        name: 'ç¯å¢ƒå…‰',
        icon: 'ğŸŒ•',
        description: 'åˆ›å»ºä¸€ä¸ªç¯å¢ƒå…‰'
      },
      {
        type: 'hemisphereLight',
        name: 'åŠçƒå…‰',
        icon: 'ğŸŒ—',
        description: 'åˆ›å»ºä¸€ä¸ªåŠçƒå…‰'
      }
    ]);

    // å…¶ä»–å¯¹è±¡æ•°æ®
    const otherPrimitives = ref([
      {
        type: 'camera',
        name: 'ç›¸æœº',
        icon: 'ğŸ“·',
        description: 'åˆ›å»ºä¸€ä¸ªé€è§†ç›¸æœº'
      },
      {
        type: 'group',
        name: 'ç©ºå¯¹è±¡',
        icon: 'ğŸ“¦',
        description: 'åˆ›å»ºä¸€ä¸ªç©ºçš„ç»„å¯¹è±¡'
      },
      {
        type: 'text',
        name: 'æ–‡æœ¬',
        icon: 'ğŸ“',
        description: 'åˆ›å»ºä¸€ä¸ª3Dæ–‡æœ¬å¯¹è±¡'
      },
      {
        type: 'sprite',
        name: 'ç²¾çµ',
        icon: 'ğŸ­',
        description: 'åˆ›å»ºä¸€ä¸ªç²¾çµå¯¹è±¡'
      }
    ]);
    
    // ä»assets composableè·å–çŠ¶æ€
    const {
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      
      // æ–¹æ³•
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop
    } = assets;
    
    // è®¡ç®—å±æ€§
    // categoriesã€toggleSortOrderç­‰å·²ç§»é™¤
    
    /**
     * é€‰ä¸­æ¨¡å‹
     * @param {Object} model æ¨¡å‹å¯¹è±¡
     */
    function selectModel(model) {
      selectedAssetId.value = model.id;
    }
    
    /**
     * é€‰ä¸­çº¹ç†
     * @param {Object} texture çº¹ç†å¯¹è±¡
     */
    function selectTexture(texture) {
      selectedAssetId.value = texture.id;
    }
    
    /**
     * æ˜¾ç¤ºæ¨¡å‹æ›´å¤šé€‰é¡¹ï¼ˆå¾…å®ç°ï¼‰
     * @param {Object} model æ¨¡å‹å¯¹è±¡
     */
    function showModelOptions(model) {
      // TODO: æ˜¾ç¤ºæ¨¡å‹é€‰é¡¹å¯¹è¯æ¡†
      console.log('æ˜¾ç¤ºæ¨¡å‹é€‰é¡¹:', model);
    }
    
    /**
     * å°†çº¹ç†åº”ç”¨åˆ°é€‰ä¸­çš„å¯¹è±¡
     * @param {Object} texture çº¹ç†å¯¹è±¡
     */
    function applyTextureToSelected(texture) {
      const selectedObjects = objectSelection.selectedObjects.value;
      if (selectedObjects.length === 0) {
        alert('è¯·å…ˆé€‰æ‹©è¦åº”ç”¨çº¹ç†çš„å¯¹è±¡');
        return;
      }
      
      selectedObjects.forEach(object => {
        if (object.material) {
          object.material.map = texture.texture;
          object.material.needsUpdate = true;
        }
      });
    }
    
    /**
     * æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
     * @param {number} bytes å­—èŠ‚æ•°
     * @returns {string} æ ¼å¼åŒ–ç»“æœ
     */
    function formatFileSize(bytes) {
      if (bytes === 0) return '0 B';
      const k = 1024;
      const sizes = ['B', 'KB', 'MB', 'GB'];
      const i = Math.floor(Math.log(bytes) / Math.log(k));
      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
    }
    
    /**
     * è·å–ä¸Šä¼ çŠ¶æ€æ–‡æœ¬
     * @param {string} status çŠ¶æ€ç 
     * @returns {string} çŠ¶æ€æ–‡æœ¬
     */
    function getStatusText(status) {
      const statusMap = {
        pending: 'ç­‰å¾…ä¸­',
        uploading: 'ä¸Šä¼ ä¸­',
        completed: 'å·²å®Œæˆ',
        failed: 'å¤±è´¥'
      };
      return statusMap[status] || status;
    }

    // æ·»åŠ å‡ ä½•ä½“åˆ°åœºæ™¯
    /**
     * æ·»åŠ å‡ ä½•ä½“åˆ°åœºæ™¯
     * @param {string} type å‡ ä½•ä½“ç±»å‹
     */
    function addPrimitive(type) {
      const position = [
        Math.random() * 4 - 2,
        Math.random() * 2,
        Math.random() * 4 - 2
      ];
      
      scene.createPrimitive(type, { position });
    }

    // è§£æ„ selectAndUploadFiles ä»¥ä¾¿ setup å†…å’Œæ¨¡æ¿éƒ½èƒ½ç›´æ¥ç”¨
    const { selectAndUploadFiles } = assets;
    
    return {
      // çŠ¶æ€
      activeTab,
      selectedAssetId,
      assetLibrary,
      uploadState,
      dragState,
      filteredModels,
      filteredTextures,
      basicPrimitives,
      extendedPrimitives,
      lightPrimitives,
      otherPrimitives,
      
      // æ–¹æ³•
      selectModel,
      selectTexture,
      showModelOptions,
      applyTextureToSelected,
      formatFileSize,
      getStatusText,
      addModelToScene,
      deleteAsset,
      toggleFavorite,
      handleDragEnter,
      handleDragLeave,
      handleDrop,
      addPrimitive,
      selectAndUploadFiles
    };
  }
};
</script>

<style scoped>
.asset-browser {
  width: 100%;
  height: 100%;
  background: #2a2a2a;
  border-right: 1px solid #444;
  display: flex;
  flex-direction: column;
  color: #fff;
}

.browser-header {
  padding: 16px;
  border-bottom: 1px solid #444;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.browser-header h3 {
  margin: 0;
  font-size: 16px;
  font-weight: 600;
}

.header-actions {
  display: flex;
  gap: 8px;
}

.upload-btn {
  display: flex;
  align-items: center;
  gap: 4px;
  padding: 6px 12px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
}

.upload-btn:hover {
  background: #0088dd;
}

.clear-btn {
  padding: 6px 8px;
  background: #d73a49;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.clear-btn:hover {
  background: #e85662;
}

.browser-filters {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
}

.search-box {
  position: relative;
  margin-bottom: 12px;
}

.search-input {
  width: 100%;
  padding: 8px 32px 8px 12px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.search-input:focus {
  outline: none;
  border-color: #007acc;
}

.search-icon {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  color: #aaa;
  font-size: 14px;
}

.filter-controls {
  display: flex;
  gap: 8px;
  align-items: center;
}

.category-select,
.sort-select {
  flex: 1;
  padding: 6px 8px;
  background: #333;
  border: 1px solid #555;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
}

.sort-order-btn {
  padding: 6px 8px;
  background: #555;
  border: none;
  border-radius: 4px;
  color: #fff;
  cursor: pointer;
}

.sort-order-btn:hover {
  background: #666;
}

.drag-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 122, 204, 0.8);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1000;
}

.drag-content {
  text-align: center;
  color: #fff;
}

.drag-icon {
  font-size: 48px;
  display: block;
  margin-bottom: 16px;
}

.upload-progress {
  padding: 12px 16px;
  border-bottom: 1px solid #444;
  background: #333;
}

.progress-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 8px;
  font-size: 12px;
}

.progress-bar {
  height: 4px;
  background: #555;
  border-radius: 2px;
  overflow: hidden;
  margin-bottom: 8px;
}

.progress-fill {
  height: 100%;
  background: #007acc;
  transition: width 0.3s;
}

.upload-queue {
  max-height: 120px;
  overflow-y: auto;
}

.upload-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 4px 0;
  font-size: 11px;
}

.upload-item.completed {
  color: #4caf50;
}

.upload-item.failed {
  color: #f44336;
}

.asset-tabs {
  display: flex;
  border-bottom: 1px solid #444;
}

.tab-btn {
  flex: 1;
  padding: 12px 16px;
  background: #333;
  border: none;
  border-bottom: 2px solid transparent;
  color: #aaa;
  font-size: 12px;
  cursor: pointer;
}

.tab-btn:hover {
  background: #444;
  color: #fff;
}

.tab-btn.active {
  background: #2a2a2a;
  border-bottom-color: #007acc;
  color: #fff;
}

.asset-grid {
  flex: 1;
  overflow-y: auto;
  padding: 16px;
}

.models-grid,
.textures-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
  gap: 12px;
}

.asset-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 8px;
  overflow: hidden;
  cursor: pointer;
  transition: all 0.2s;
  position: relative;
}

.asset-item:hover {
  border-color: #777;
  transform: translateY(-2px);
}

.asset-item.selected {
  border-color: #007acc;
  box-shadow: 0 0 0 1px #007acc;
}

.asset-preview {
  position: relative;
  width: 100%;
  height: 80px;
  overflow: hidden;
}

.preview-image {
  width: 100%;
  height: 100%;
  object-fit: cover;
}

.preview-placeholder {
  width: 100%;
  height: 100%;
  background: #555;
  display: flex;
  align-items: center;
  justify-content: center;
}

.placeholder-icon {
  font-size: 24px;
  color: #888;
}

.favorite-btn {
  position: absolute;
  top: 4px;
  right: 4px;
  background: rgba(0, 0, 0, 0.6);
  border: none;
  border-radius: 50%;
  width: 24px;
  height: 24px;
  color: #fff;
  cursor: pointer;
  font-size: 12px;
}

.favorite-btn.active {
  color: #ffd700;
}

.asset-info {
  padding: 8px;
}
.upload-item-fixed .asset-info {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.upload-item-fixed .asset-name {
  text-align: center;
  width: 100%;
}

.asset-name {
  font-size: 11px;
  font-weight: 600;
  margin-bottom: 4px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.asset-meta {
  display: flex;
  justify-content: space-between;
  font-size: 9px;
  color: #aaa;
  margin-bottom: 8px;
}

.asset-actions {
  display: flex;
  gap: 4px;
}

.action-btn {
  flex: 1;
  padding: 4px;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  font-size: 10px;
}

.add-btn {
  background: #4caf50;
  color: #fff;
}

.apply-btn {
  background: #ff9800;
  color: #fff;
}

.options-btn {
  background: #555;
  color: #fff;
}

.delete-btn {
  background: #f44336;
  color: #fff;
}

.action-btn:hover {
  opacity: 0.8;
}

.empty-state {
  text-align: center;
  padding: 40px 20px;
  color: #aaa;
}

.upload-hint-btn {
  padding: 8px 16px;
  background: #007acc;
  border: none;
  border-radius: 4px;
  color: #fff;
  font-size: 12px;
  cursor: pointer;
  margin-top: 12px;
}

.upload-hint-btn:hover {
  background: #0088dd;
}

/* å‡ ä½•ä½“æ ·å¼ */
.primitives-grid {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.primitives-section {
  margin-bottom: 16px;
}

.section-title {
  margin: 0 0 12px 0;
  font-size: 14px;
  font-weight: 600;
  color: #fff;
  border-bottom: 1px solid #555;
  padding-bottom: 8px;
}

.primitives-list {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
  gap: 8px;
}

.primitive-item {
  background: #333;
  border: 1px solid #555;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s;
  overflow: hidden;
}

.primitive-item:hover {
  background: #444;
  border-color: #777;
  transform: translateY(-1px);
}

.primitive-item:active {
  transform: translateY(0);
  background: #007acc;
  border-color: #0088dd;
}

.primitive-preview {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 60px;
  background: #2a2a2a;
}

.primitive-icon {
  font-size: 24px;
  line-height: 1;
}

.primitive-info {
  padding: 8px 6px;
  text-align: center;
}

.primitive-name {
  font-size: 10px;
  font-weight: 500;
  color: #fff;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ç§»åŠ¨ç«¯å“åº”å¼ */
@media (max-width: 768px) {
  .primitives-list {
    grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
    gap: 6px;
  }
  
  .primitive-preview {
    height: 50px;
  }
  
  .primitive-icon {
    font-size: 20px;
  }
  
  .primitive-name {
    font-size: 9px;
  }
  
  .section-title {
    font-size: 12px;
  }
}
</style>
